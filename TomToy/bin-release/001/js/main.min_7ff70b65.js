var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},BaseView=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.preOpen=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onOpen()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.preOpen.apply(this,t)},e.prototype.onOpen=function(){StageUtils.stage.addEventListener(egret.Event.RESIZE,this.onResize,this),LayerManager.I.addToLayer(this,this.layer),this.onResize(),this.show()},e.prototype.show=function(){},e.prototype.onResize=function(){this.x=StageUtils.stage.stageWidth/2,AnchorUtils.setAnchorX(this,.5)},e.prototype.close=function(){StageUtils.stage.removeEventListener(egret.Event.RESIZE,this.onResize,this),DisplayUtils.removeFromParent(this)},e}(eui.Component);__reflect(BaseView.prototype,"BaseView",["IView"]);var Scene=function(t){function e(){var e=t.call(this)||this;return e.layer=Layer.SCENE,e}return __extends(e,t),e}(BaseView);__reflect(Scene.prototype,"Scene");var GameScene=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.GameScene,e}return __extends(e,t),e.prototype.init=function(){var t=this;this.startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.start,this),this.changeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.pickRoom,this);for(var e=[this.upBtn,this.downBtn,this.leftBtn,this.rightBtn],i=[Direction.UP,Direction.DOWN,Direction.LEFT,Direction.RIGHT],n=function(n){var r=e[n],o=i[n];r.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){return t.changeDir(o)},a),r.addEventListener(egret.TouchEvent.TOUCH_END,a.cancelDir,a),r.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,a.cancelDir,a)},a=this,r=0;4>r;r++)n(r);this.catchBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this["catch"],this),this.catchData=new CatchData,this.bulletData=new BulletData,this.bulletData.user_id=PlayerDataManager.get(PlayerDataKey.ID),this.bulletData.username=PlayerDataManager.get(PlayerDataKey.NAME),this.bulletData.avtar=PlayerDataManager.get(PlayerDataKey.HEAD),this.infoBtn.setOnTap(function(){return ViewManager.I.open(ViewName.DLG_TOY_INFO,t.roomId)}),LocalDataManager.addDataListener(LocalDataKey.BULLET,function(e){e?t.bulletView.start(t.roomId):t.bulletView.stop()})},e.prototype.preOpen=function(e){this.roomId=e,t.prototype.preOpen.call(this)},e.prototype.show=function(){GameConfig.ROOM=this,this.operateGroup.visible=!1,this.startGroup.visible=!0,this.startGroup.touchChildren=!0,this.giftBtns.x=-5;var t=this.roomId,e=DataManager.getRoom(t);this.cost.text=e.cost+"/次",this.price=e.cost,this.toyWorld.init(),this.toyWorld.showToy(DataManager.getToysByRoom(t)),this.gameTimer.visible=!1,this.failHint.visible=!1,this.luckyHint.visible=!1,this.luckyBar.start(t),this.roomUsers.start(t),LocalDataManager.get(LocalDataKey.BULLET)&&this.bulletView.start(t),this.tips.start(),this.leftLamp.start(),this.rightLamp.start()},e.prototype.close=function(){t.prototype.close.call(this),this.toyWorld.end(),this.roomUsers.stop(),this.bulletView.stop(),this.tips.stop(),this.leftLamp.stop(),this.rightLamp.stop()},e.prototype.changeRoom=function(t){this.moveScene(ViewManager.I.open(ViewName.BACKUP,22))},e.prototype.moveScene=function(t){var e=this;this.parent.addChild(t);var i=this.front.width;t.x=this.x+i,egret.Tween.get(this).to({x:this.x-i},300).call(function(){e.close()}),egret.Tween.get(t).to({x:this.x},300)},e.prototype.start=function(){var t=this;return PlayerDataManager.get(PlayerDataKey.COIN)<this.price?(ViewManager.I.open(ViewName.DLG_CHARGE),void ViewManager.I.open(ViewName.POP_HINT,"金币不足，请前去充值！")):void HttpManager.post(HttpCmd.CATCH_START,{user_id:PlayerDataManager.get(PlayerDataKey.ID),ufo_id:this.roomId},function(e){var i=e.prize;t.catchData["catch"]=i.catchedToy,t.catchData.catchId=parseInt(i.prepareCatchId),t.catchData.lucky=i.userLuckyScore,t.catchData.toyId=0,t.catchData.catch_times=i.catchTimes,PlayerDataManager.updateCoin(),t.toOperate(),t.toyWorld.start(),t.gameTimer.start(20,t["catch"].bind(t)),SoundManager.I.playEffect("start_mp3")},null,!0)},e.prototype.end=function(){if(this.bulletData.catch_times=this.catchData.catch_times,this.bulletData.toy_name=this.catchData.toyId>0?DataManager.getToy(this.catchData.toyId).name:"娃娃",this.catchData["catch"]&&this.catchData.toyId>0)this.luckyBar.setLucky(0),this.bulletView.addNotice(this.bulletData),ViewManager.I.open(ViewName.DLG_CATCH_TOY,this.catchData.toyId,this.catchData.catch_times),SoundManager.I.playEffect("suc_mp3");else{this.failHint.show();var t=this.catchData.lucky;this.luckyHint.show(t>=100,t-this.luckyBar.value),this.luckyBar.setLucky(t),this.bulletView.addBullet(this.bulletData)}this.toStart()},e.prototype.toOperate=function(){var t=this;this.hideTable(this.startGroup,function(){t.showTable(t.operateGroup)}),egret.Tween.get(this.giftBtns).to({x:-200},500)},e.prototype.toStart=function(){var t=this;this.hideTable(this.operateGroup,function(){t.showTable(t.startGroup)}),egret.Tween.get(this.giftBtns).to({x:-5},500)},e.prototype.showTable=function(t,e){void 0===e&&(e=null),t.visible=!0,t.touchChildren=!1,t.scaleY=0,egret.Tween.get(t).to({scaleY:1},250).call(function(){t.touchChildren=!0,e&&e()})},e.prototype.hideTable=function(t,e){void 0===e&&(e=null),t.touchChildren=!1,egret.Tween.get(t).to({scaleY:0},250).call(function(){t.visible=!1,e&&e()},this)},e.prototype.changeDir=function(t){this.toyWorld.setDirection(t)},e.prototype.cancelDir=function(){this.toyWorld.setDirection(null)},e.prototype["catch"]=function(){this.gameTimer.stop();var t=this.toyWorld.startCatch();this.operateGroup.touchEnabled=!1,this.toyWorld.setResult(this.catchData["catch"]&&null!=t),this.catchData.toyId=t?t.id:0;var e={user_id:PlayerDataManager.get(PlayerDataKey.ID),ufo_id:this.roomId,prepareCatchId:this.catchData.catchId,toyId:this.catchData.toyId};t?this.catchData["catch"]?HttpManager.post(HttpCmd.CATCH_SUC,e):HttpManager.post(HttpCmd.CATCH_FAIL,e):HttpManager.post(HttpCmd.CATCH_LOST,e)},e.prototype.pickRoom=function(){ViewManager.I.open(ViewName.DLG_CHOOSE_ROOM,this.roomId)},e}(Scene);__reflect(GameScene.prototype,"GameScene");var UIComponent=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){},e}(eui.Component);__reflect(UIComponent.prototype,"UIComponent");var GameObject=function(t){function e(){var e=t.call(this)||this;return e.shadow=new egret.Shape,e}return __extends(e,t),e.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.vx=this.vy=this.vz=0},e.prototype.addTo=function(t){t.addChild(this),t.addChild(this.shadow),t.setChildIndex(this.shadow,0)},Object.defineProperty(e.prototype,"vx",{get:function(){return this._vx},set:function(t){this._vx=t,this.x=this._vx,this.shadow.x=this._vx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vy",{get:function(){return this._vy},set:function(t){this._vy=t,this.y=this._vy-this._vz,this.shadow.y=this._vy;var e=GameConfig.RANGE_Y,i=GameConfig.INI_SCALE;this.scaleX=this.scaleY=this.shadow.scaleX=this.shadow.scaleY=i+this._vy/e*.05},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vz",{get:function(){return this._vz},set:function(t){this._vz=t,this.y=this._vy-this._vz},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){DisplayUtils.removeFromParent(this),DisplayUtils.removeFromParent(this.shadow)},e}(eui.Component);__reflect(GameObject.prototype,"GameObject");var Dialog=function(t){function e(){var e=t.call(this)||this;return e.layer=Layer.DIALOG,e._black=new egret.Sprite,e}return __extends(e,t),e.prototype.init=function(){AnchorUtils.setAnchor(this,.5),this.closeBtn&&this.closeBtn.setOnTap(this.close.bind(this))},e.prototype.onOpen=function(){LayerManager.I.addToLayer(this._black,Layer.DIALOG),this._black.alpha=.3,this._black.touchEnabled=!0,this.scaleX=this.scaleY=.5,this.alpha=1,egret.Tween.get(this).to({scaleX:1,scaleY:1},400,egret.Ease.backOut),t.prototype.onOpen.call(this)},e.prototype.onResize=function(){this.x=StageUtils.stageW/2,this.y=StageUtils.stageH/2,DrawUtils.drawRect(this._black,StageUtils.stageW,StageUtils.stageH,0),t.prototype.onResize.call(this)},e.prototype.close=function(){var e=this;egret.Tween.get(this).to({alpha:0,scaleX:.1,scaleY:.1},150).call(function(){DisplayUtils.removeFromParent(e._black),t.prototype.close.call(e)},this),egret.Tween.get(this._black).to({alpha:0},150)},e}(BaseView);__reflect(Dialog.prototype,"Dialog");var PopWin=function(t){function e(){var e=t.call(this)||this;return e.layer=Layer.POPWIN,e}return __extends(e,t),e}(BaseView);__reflect(PopWin.prototype,"PopWin");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?n(a):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Vector2=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t}();__reflect(Vector2.prototype,"Vector2");var BulletData=function(){function t(){}return t}();__reflect(BulletData.prototype,"BulletData");var CatchData=function(){function t(){}return t}();__reflect(CatchData.prototype,"CatchData");var ChargeData=function(){function t(){}return t}();__reflect(ChargeData.prototype,"ChargeData");var Config=function(){function t(){}return Object.defineProperty(t,"server",{get:function(){return this.data.server},enumerable:!0,configurable:!0}),Object.defineProperty(t,"auth",{get:function(){return this.data.auth},enumerable:!0,configurable:!0}),Object.defineProperty(t,"data",{get:function(){return null==this._data&&(this._data=RES.getRes("config_json")),this._data},enumerable:!0,configurable:!0}),t}();__reflect(Config.prototype,"Config");var DailyTaskData=function(){function t(){}return t}();__reflect(DailyTaskData.prototype,"DailyTaskData");var DataManager=function(){function t(){}return t.initRoom=function(t){var e=this;this._roomDic={},t.forEach(function(t){var i=new RoomData;i.id=parseInt(t.uc_id),i.cost=parseInt(t.uc_cost),i.size=parseInt(t.uc_size),i.icon=t.uc_icon,i.title=t.uc_title,i.pos=JSON.parse(t.uc_pos),e._roomDic[i.id]=i})},t.getRoom=function(t){return this._roomDic[t]},t.getRooms=function(){var t=[];for(var e in this._roomDic)t.push(this._roomDic[e]);return t},t.initToy=function(t){var e=this;this._toyDic={},t.forEach(function(t){var i=new ToyData;i.id=parseInt(t.ut_id),i.room=parseInt(t.uc_id),i.name=t.ut_name,i.img=t.ut_icon,i.icon=t.ut_cover_img,i.desc=t.ut_cover_img,i.w=parseInt(t.ut_width),i.h=parseInt(t.ut_height),e._toyDic[i.id]=i})},t.getToy=function(t){return this._toyDic[t]},t.initRoomToys=function(){this._roomToys={};for(var t in this._roomDic){var e=this._roomDic[t].pos;if(null!=e){var i=[];for(var n in this._toyDic){var a=this._toyDic[n];a.room==parseInt(t)&&i.push(a)}for(var r=[],o=0;o<e.length;o++){var a=i[o%i.length],s=JSON.parse(JSON.stringify(a));s.x=e[o].x,s.y=e[o].y,s.idx=o,r.push(s)}this._roomToys[t]=r}}},t.getToysByRoom=function(t){return this._roomToys[t]},t}();__reflect(DataManager.prototype,"DataManager");var InviteTaskData=function(){function t(){}return t}();__reflect(InviteTaskData.prototype,"InviteTaskData");var LoginTaskData=function(){function t(){}return t}();__reflect(LoginTaskData.prototype,"LoginTaskData");var OrderData=function(){function t(){}return t}();__reflect(OrderData.prototype,"OrderData");var PlayerShowData=function(){function t(){}return t}();__reflect(PlayerShowData.prototype,"PlayerShowData");var RecordData=function(){function t(){}return t}();__reflect(RecordData.prototype,"RecordData");var RoomData=function(){function t(){}return t}();__reflect(RoomData.prototype,"RoomData");var ToyData=function(){function t(){}return t}();__reflect(ToyData.prototype,"ToyData");var ChargeItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.ChargeItem,e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t.ps_is_newer?(this.skinName=skins.NewGiftItem,this.btn.visible=!1,this.finished.visible=!1,0==t.ps_is_done?this.btn.visible=!0:1==t.ps_is_done&&(this.finished.visible=!0)):(this.skinName=skins.ChargeItem,this.icon.source=t.ps_amount>=1e3?"ui_json.bag_coin":"ui_json.coin"),this.desc.textFlow=[{text:t.ps_amount,style:{}},{text:t.ps_bonus_coin>0?"+"+t.ps_bonus_coin:"",style:{textColor:16732061}},{text:"金币",style:{}}],this.btn.labelDisplay.text="¥"+t.ps_rmb_coin,this.btn.setOnTap(this.charge.bind(this))},e.prototype.charge=function(){ViewManager.I.doFunc(ViewName.DLG_CHARGE,"charge",this.data.ps_id)},e}(eui.ItemRenderer);__reflect(ChargeItem.prototype,"ChargeItem");var DailyTaskItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DailyTaskItem,e.cacheAsBitmap=!0,e.once(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){this.drawBtn.setOnTap(this.draw.bind(this))},e.prototype.dataChanged=function(){var t=this.data;switch(this.taskName.text=t.task_title,this.desc.text="奖励：金币×"+parseInt(t.task_bonus_coin)+" 任务积分×"+parseInt(t.task_bonus_score),this.drawBtn.visible=!1,this.finished.visible=!1,this.unFinished.visible=!1,t.status){case-1:this.unFinished.visible=!0;break;case 0:this.drawBtn.visible=!0;break;case 1:this.finished.visible=!0}t.status<=0&&(this.taskName.textFlow=[{text:t.task_title+"(",style:{}},{text:t.progress,style:{textColor:4237572}},{text:")",style:{}}])},e.prototype.draw=function(){HttpManager.post(HttpCmd.DAILY_TASK_RECEIVE,{task_id:this.data.task_id,user_id:PlayerDataManager.get(PlayerDataKey.ID),category_id:this.data.task_cat_id},function(t){t.mission.toyId>0&&ViewManager.I.open(ViewName.POP_ALERT,"获得一个神秘娃娃，去背包看一看吧！","前往",function(){ViewManager.I.open(ViewName.DLG_BAG)}),PlayerDataManager.updateCoin(),ViewManager.I.doFunc(ViewName.DLG_DAILY_TASK,"refresh")},null,!0)},e}(eui.ItemRenderer);__reflect(DailyTaskItem.prototype,"DailyTaskItem");var DlgBag=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgBag,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.toyTab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showToy,this),this.orderTab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showorder,this),this.pickBtn.setOnTap(this.pick.bind(this)),this.nextBtn.setOnTap(this.next.bind(this)),this.subBtn.setOnTap(this.sub.bind(this)),this.nameText.maxChars=7,this.phoneText.inputType=egret.TextFieldInputType.TEL,this.phoneText.restrict="0-9",this.phoneText.maxChars=11,this.addrText.maxChars=40},e.prototype.preOpen=function(){var e=this,i=-2,n=function(){i+=1,0==i&&t.prototype.preOpen.call(e)};HttpManager.post(HttpCmd.BAG_LIST,{user_id:PlayerDataManager.get(PlayerDataKey.ID)},function(t){e.toys=t.result.list,n()},null,!0),HttpManager.post(HttpCmd.ORDER_LIST,{user_id:PlayerDataManager.get(PlayerDataKey.ID)},function(t){e.orders=t.result.list,n()},null,!0)},e.prototype.show=function(){this.clear();var t=this.toys.length>0;if(t)for(var e=0;e<this.toys.length;e++){var i=ObjectPool.pop("ToyItem"),n=this.toys[e],a=DataManager.getToy(n.pack_toy_id);i.show(a,n.pack_balance_num),this.toyGroup.addChild(i)}this.pickBtn.visible=t,this.toyHint.visible=!t;var r=new eui.ArrayCollection(this.orders);this.orderList.dataProvider=r,this.orderList.itemRenderer=OrderItem,this.orderHint.visible=0==this.orders.length,this.bagView.visible=!0,this.drawView.visible=!1,this.showToy()},e.prototype.showToy=function(){this.toyView.visible=!0,this.toyTab.enabled=!1,this.orderView.visible=!1,this.orderTab.enabled=!0},e.prototype.showorder=function(){this.toyView.visible=!1,this.toyTab.enabled=!0,this.orderView.visible=!0,this.orderTab.enabled=!1},e.prototype.clear=function(){for(var t=this.toyGroup.numChildren,e=0;t>e;e++){var i=this.toyGroup.getChildAt(0);i.destroy()}},e.prototype.pick=function(){this.bagView.visible=!1,this.drawView.visible=!0,this.pickView.visible=!0,this.infoView.visible=!1;for(var t=[],e=0;e<this.toys.length;e++){var i=this.toys[e];t.push({id:i.pack_toy_id,count:i.pack_balance_num,onChange:this.onChange.bind(this)})}var n=new eui.ArrayCollection(t);this.pickList.dataProvider=n,this.pickList.itemRenderer=PickItem,this.pickData={},this.pickCount=0,this.pickHint.visible=!0},e.prototype.onChange=function(t,e){this.pickData[t]=e,this.pickCount=0;for(var i in this.pickData)this.pickCount+=this.pickData[i];this.pickHint.visible=this.pickCount<2},e.prototype.next=function(){if(0!=this.pickCount){if(this.pickCount<2&&PlayerDataManager.get(PlayerDataKey.COIN)<100)return ViewManager.I.open(ViewName.DLG_CHARGE),void ViewManager.I.open(ViewName.POP_HINT,"金币不足，请前去充值！");this.pickView.visible=!1,this.infoView.visible=!0;var t=LocalDataManager.get(LocalDataKey.ADDRESS);t&&(this.nameText.text=t.name,this.phoneText.text=t.phone,this.addrText.text=t.addr)}},e.prototype.sub=function(){var t,e=this,i=this.nameText.text,n=this.phoneText.text,a=this.addrText.text;if(""==i?t="请填写姓名":MathUtils.checkName(i)?""==n?t="请填写手机号码":MathUtils.checkMobile(n)?""==a&&(t="请填写详细地址"):t="请填写正确的手机号码":t="请填写正确的姓名",t)return void ViewManager.I.open(ViewName.POP_HINT,t);LocalDataManager.set(LocalDataKey.ADDRESS,{name:i,phone:n,addr:a});var r=[];for(var o in this.pickData)r.push({ut_id:o,num:this.pickData[o]});console.log(r),HttpManager.post(HttpCmd.EXCHANGE,{user_id:PlayerDataManager.get(PlayerDataKey.ID),exchg_username:i,exchg_phone:n,exchg_address:a,plist:JSON.stringify(r)},function(t){e.close(),ViewManager.I.open(ViewName.POP_HINT,"提取成功！"),e.pickCount<2&&PlayerDataManager.updateCoin()},null,!0)},e}(Dialog);__reflect(DlgBag.prototype,"DlgBag");var DlgBind=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgBind,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.codeBtn.setOnTap(this.sendCode.bind(this)),this.bindBtn.setOnTap(this.bindPhone.bind(this)),this.phone.maxChars=11,this.phone.inputType=egret.TextFieldInputType.TEL,this.code.maxChars=6,this.code.inputType=egret.TextFieldInputType.TEL},e.prototype.sendCode=function(){var t=this,e=this.phone.text;this.checkPhone(e)&&HttpManager.post(HttpCmd.SEND_CODE,{phone:e},function(e){t.codeBtn.visible=!1,t.time.visible=!0,t.count=61,t.updateTime(),TimerManager.doTimer(1e3,60,t.updateTime,t,function(){t.codeBtn.visible=!0,t.time.visible=!1})},null,!0)},e.prototype.updateTime=function(){this.count-=1,this.time.text=this.count+"秒后获取"},e.prototype.bindPhone=function(){var t=this,e=this.phone.text,i=this.code.text;this.checkPhone(e)&&this.checkCode(i)&&HttpManager.post(HttpCmd.BIND_PHONE,{phone:e,user_id:PlayerDataManager.get(PlayerDataKey.ID),code:i},function(i){PlayerDataManager.set(PlayerDataKey.PHONE,e),PlayerDataManager.updateCoin(),t.close()},null,!0)},e.prototype.checkPhone=function(t){var e;return""==t?e="请填写手机号码":MathUtils.checkMobile(t)||(e="请填写正确的手机号码"),e&&ViewManager.I.open(ViewName.POP_HINT,e),null==e},e.prototype.checkCode=function(t){var e;return""==t?e="请填写验证码":t.length<6&&(e="请填写正确的验证码"),e&&ViewManager.I.open(ViewName.POP_HINT,e),null==e},e}(Dialog);__reflect(DlgBind.prototype,"DlgBind");var DlgCatchToy=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgCatchToy,e}return __extends(e,t),e.prototype.preOpen=function(e,i){this.catchId=e,this.catchTimes=i,t.prototype.preOpen.call(this)},e.prototype.show=function(){var t=DataManager.getToy(this.catchId);this.toy.source=t.icon,this.content.text="抓到了一个"+t.name;for(var e=100,i=1;i<=this.catchTimes;i++){var n=i>11?22-i:i;0>=n&&(n=2),e-=Math.ceil(Math.sqrt(n))}0>=e&&(e=1),this.desc.textFlow=[{text:"你抓了"+this.catchTimes+"次抓到了，超过了",style:{}},{text:e+"%",style:{textColor:16732061}},{text:"的玩家",style:{}}]},e}(Dialog);__reflect(DlgCatchToy.prototype,"DlgCatchToy");var DlgCharge=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgCharge,e}return __extends(e,t),e.prototype.init=function(){var e=this;this.payClose.setOnTap(function(){e.payView.visible=!1}),this.wxBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.wxPay,this),this.aliBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.aliPay,this),t.prototype.init.call(this)},e.prototype.preOpen=function(){var e=this;HttpManager.post(HttpCmd.CHARGE_LIST,{user_id:PlayerDataManager.get(PlayerDataKey.ID)},function(i){e.datas=[];var n=[];for(var a in i.list){var r=i.list[a];1==r.ps_is_done?n.push(r):e.datas.push(r)}e.datas=e.datas.concat(n),t.prototype.preOpen.call(e)},null,!0)},e.prototype.show=function(){var t=new eui.ArrayCollection(this.datas);this.list.dataProvider=t,this.list.itemRenderer=ChargeItem,this.payView.visible=!1},e.prototype.charge=function(t){this.payId=t,this.payView.visible=!0},e.prototype.wxPay=function(){WxPlatform.pay(this.payId)},e.prototype.aliPay=function(){AliPlatform.pay(this.payId)},e}(Dialog);__reflect(DlgCharge.prototype,"DlgCharge");var DlgChooseRoom=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgChooseRoom,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this);var e=[],i=DataManager.getRooms();i.forEach(function(t){e.push(t.id)}),this.roomIds=e,this.showRooms=[],this.changeBtn.setOnTap(this.refresh.bind(this))},e.prototype.preOpen=function(e){this.curRoom=e,this.showRooms=[],t.prototype.preOpen.call(this)},e.prototype.show=function(){this.refresh()},e.prototype.refresh=function(){var t=this,e=[];this.roomIds.forEach(function(i){t.showRooms.indexOf(i)<0&&t.curRoom!=i&&e.push(i)}),e.sort(function(){return.5-Math.random()}),this.showRooms=e.slice(0,4),this.clear();for(var i=0;i<this.showRooms.length;i++){var n=ObjectPool.pop("RoomItem"),a=DataManager.getRoom(this.showRooms[i]);n.show(a),this.group.addChild(n),n.touchEnabled=!0}},e.prototype.clear=function(){for(var t=this.group.numChildren,e=0;t>e;e++){var i=this.group.getChildAt(0);i.destroy()}},e}(Dialog);__reflect(DlgChooseRoom.prototype,"DlgChooseRoom");var DlgDailyGift=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgDailyGift,e}return __extends(e,t),e.prototype.init=function(){this.subBtn.setOnTap(this.sub.bind(this)),t.prototype.init.call(this)},e.prototype.show=function(){},e.prototype.sub=function(){HttpManager.post(HttpCmd.DAILY_GIFT_RECEIVE,{user_id:PlayerDataManager.get(PlayerDataKey.ID),gift_code:this.code.text},function(t){PlayerDataManager.updateCoin()},null,!0)},e}(Dialog);__reflect(DlgDailyGift.prototype,"DlgDailyGift");var DlgDailyTask=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgDailyTask,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.bar.parent.addChild(this.barMask=new egret.Shape);var e=this.barMask.graphics;e.beginFill(0),e.drawRect(0,0,this.bar.width,this.bar.height),e.endFill(),this.barMask.y=this.bar.y,this.barMask.x=this.bar.x-this.bar.width,this.bar.mask=this.barMask,this.score=0,this.list.cacheAsBitmap=!0},e.prototype.preOpen=function(){this.refresh(t.prototype.preOpen.bind(this))},e.prototype.refresh=function(t){var e=this;void 0===t&&(t=null),HttpManager.post(HttpCmd.DAILY_TASK_LIST,{user_id:PlayerDataManager.get(PlayerDataKey.ID)},function(i){var n=i.list.finished,a=i.list.unfinished,r=[],o=[],s=[];for(var h in n){var c=n[h];1==c.utl_status?(c.status=1,c.task_cat_id=c.utl_cat_id,o.push(c)):s.indexOf(c.utl_cat_id)<0&&(s.push(c.utl_cat_id),c.status=0,c.task_cat_id=c.utl_cat_id,r.push(c))}for(var h in a){var c=a[h];s.indexOf(c.task_cat_id)<0&&(s.push(c.task_cat_id),c.status=-1,r.push(c))}e.datas=r.concat(o),e.datas.forEach(function(t){switch(t.task_cat_id){case"1":t.progress=i.list.userDailyCatchTimes+"/"+t.task_need_catch_times;break;case"2":t.progress=i.list.userDailyCatchedTimes+"/"+t.task_need_catch_times;break;case"3":t.progress=i.list.userDailyRecharge+"/"+t.task_need_recharge_money}}),e.setScore(i.list.userDailyScore);var l=new eui.ArrayCollection(e.datas);e.list.dataProvider=l,e.list.itemRenderer=DailyTaskItem,t&&t()},null,!0)},e.prototype.show=function(){},e.prototype.setScore=function(t){var e=500;egret.Tween.removeTweens(this),egret.Tween.get(this).to({score:t},e)},Object.defineProperty(e.prototype,"value",{get:function(){return this.score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"score",{get:function(){return this._score},set:function(t){this._score=t,this.progress.text=Math.floor(t)+"/100",this.barMask.x=this.bar.x+this.bar.width*(t/100-1)},enumerable:!0,configurable:!0}),e}(Dialog);__reflect(DlgDailyTask.prototype,"DlgDailyTask");var DlgInvite=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgInvite,e}return __extends(e,t),e.prototype.init=function(){this.shareBtn.setOnTap(this.invite.bind(this)),this.drawBtn.setOnTap(this.draw.bind(this)),this.list.cacheAsBitmap=!0,t.prototype.init.call(this)},e.prototype.preOpen=function(){this.refresh(t.prototype.preOpen.bind(this))},e.prototype.refresh=function(t){var e=this;void 0===t&&(t=null),HttpManager.post(HttpCmd.INVITE_TASK_LIST,{user_id:PlayerDataManager.get(PlayerDataKey.ID)},function(i){var n=i.result.invite_tasks;e.datas=[];for(var a=[],r=0;r<n.length;r++){var o=n[r];"1"==o.finished_status?a.push(o):e.datas.push(o)}e.datas=e.datas.concat(a);var s=new eui.ArrayCollection(e.datas);e.list.dataProvider=s,e.list.itemRenderer=InviteItem,e.lastShare=i.result.latest_invite_share,e.check(),t&&t()},null,!0)},e.prototype.show=function(){},e.prototype.invite=function(){WxPlatform.share("xx","xx"),LocalDataManager.set(LocalDataKey.SHARE,!0),this.check()},e.prototype.draw=function(){var t=this;HttpManager.post(HttpCmd.SHARE_RECEIVE,{user_id:PlayerDataManager.get(PlayerDataKey.ID)},function(e){t.lastShare=e.result.latest_invite_share,PlayerDataManager.updateCoin(),t.check()},null,!0)},e.prototype.check=function(){var t=LocalDataManager.get(LocalDataKey.SHARE);this.drawBtn.visible=!1,this.shareBtn.visible=!1,t?this.lastShare&&DateUtils.checkDay(new Date(DateUtils.convertDate(this.lastShare)),new Date)?this.shareBtn.visible=!0:this.drawBtn.visible=!0:this.shareBtn.visible=!0},e}(Dialog);__reflect(DlgInvite.prototype,"DlgInvite");var DlgLoginTask=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgLoginTask,e}return __extends(e,t),e.prototype.preOpen=function(){var e=this;HttpManager.post(HttpCmd.CHECKIN_LIST,{user_id:PlayerDataManager.get(PlayerDataKey.ID)},function(i){e.datas=i.result.tasks;for(var n=i.result.user_checkins,a=!1,r=0;r<e.datas.length;r++){var o=e.datas[r],s=n[r];s?(o.ucgl_id=s.ucgl_id,o.status=parseInt(s.ucgl_status),0==o.status&&(a=!0)):o.status=-1}a?t.prototype.preOpen.call(e):e.close()},null,!0)},e.prototype.show=function(){var t=new eui.ArrayCollection(this.datas);this.list.dataProvider=t,this.list.itemRenderer=LoginItem},e}(Dialog);__reflect(DlgLoginTask.prototype,"DlgLoginTask");var DlgNotice=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgNotice,e}return __extends(e,t),e.prototype.init=function(){this.list.cacheAsBitmap=!0,t.prototype.init.call(this)},e.prototype.preOpen=function(){var e=this;HttpManager.post(HttpCmd.MESSAGE_LIST,{},function(i){e.datas=i.list,t.prototype.preOpen.call(e)},null,!0)},e.prototype.show=function(){var t=new eui.ArrayCollection(this.datas);this.list.dataProvider=t,this.list.itemRenderer=NoticeItem},e.prototype.close=function(){t.prototype.close.call(this),ViewManager.I.open(ViewName.DLG_LOGIN_TASK)},e}(Dialog);__reflect(DlgNotice.prototype,"DlgNotice");var DlgSetting=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgSetting,e}return __extends(e,t),e.prototype.init=function(){this.soundBtn.setOnTap(function(){LocalDataManager.set(LocalDataKey.SOUND,!LocalDataManager.get(LocalDataKey.SOUND))}),LocalDataManager.addDataListener(LocalDataKey.SOUND,this.checkSound.bind(this)),this.bulletBtn.setOnTap(function(){LocalDataManager.set(LocalDataKey.BULLET,!LocalDataManager.get(LocalDataKey.BULLET))}),LocalDataManager.addDataListener(LocalDataKey.BULLET,this.checkBullet.bind(this)),this.checkSound(),this.checkBullet(),this.quitBtn.setOnTap(this.quit.bind(this)),t.prototype.init.call(this)},e.prototype.checkSound=function(){var t=this.soundBtn.getChildAt(0);t.source=LocalDataManager.get(LocalDataKey.SOUND)?"ui_json.music_off":"ui_json.music_on"},e.prototype.checkBullet=function(){var t=this.bulletBtn.getChildAt(0);t.source=LocalDataManager.get(LocalDataKey.BULLET)?"ui_json.bullet_off":"ui_json.bullet_on"},e.prototype.show=function(){},e.prototype.quit=function(){this.close(),GameConfig.ROOM.close(),ViewManager.I.open(ViewName.LOGIN),LocalDataManager.set(LocalDataKey.ID,null)},e}(Dialog);__reflect(DlgSetting.prototype,"DlgSetting");var DlgShow=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgShow,e}return __extends(e,t),e.prototype.init=function(){for(var e=this,i=[],n=0;4>n;n++){var a=new PlayerShowData;a.image="player_show_png",a.head="player_show_head_png",a.nickname="薇天王"+n,a.desc="是同事介绍我来玩的，看到他抓的娃娃好漂亮，然后我就开始了汤姆抓娃娃，收获非常丰厚",i.push(a)}this.arr=i,this.leftBtn.setOnTap(function(){return e.turn(-1)}),this.rightBtn.setOnTap(function(){return e.turn(1)}),t.prototype.init.call(this)},e.prototype.turn=function(t){var e=this,i=0,n=this.arr.length-1,a=e.curindex+t;a=MathUtils.between(a,i,n);var r=this.arr[a];e.showImage.source=r.image,e.head.source=r.head,e.nickname.text=r.nickname,e.desc.text=r.desc,e.leftBtn.visible=a!=i,e.rightBtn.visible=a!=n,e.curindex=a},e.prototype.show=function(){this.curindex=MathUtils.randomInt(0,this.arr.length-1),this.turn(0)},e}(Dialog);__reflect(DlgShow.prototype,"DlgShow");var DlgToyInfo=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.DlgToyInfo,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.recordTab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showRecord,this),this.infoTab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showInfo,this),this.recordList.cacheAsBitmap=!0},e.prototype.preOpen=function(e){var i=this;HttpManager.post(HttpCmd.CATCH_RECORD_LIST,{ufo_id:e},function(e){i.datas=e.result.list,t.prototype.preOpen.call(i)},null,!0);var n=DataManager.getToysByRoom(e),a=[];n.forEach(function(t){a.indexOf(t.desc)<0&&a.push(t.desc)}),this.images=a},e.prototype.show=function(){var t=new eui.ArrayCollection(this.datas);this.recordList.dataProvider=t,this.recordList.itemRenderer=RecordItem;var e=new eui.ArrayCollection(this.images);this.infoList.dataProvider=e,this.infoList.itemRenderer=InfoItem,this.showRecord()},e.prototype.showRecord=function(){this.recordList.parent.visible=!0,this.recordTab.enabled=!1,this.infoList.parent.visible=!1,this.infoTab.enabled=!0},e.prototype.showInfo=function(){this.recordList.parent.visible=!1,this.recordTab.enabled=!0,this.infoList.parent.visible=!0,this.infoTab.enabled=!1},e}(Dialog);__reflect(DlgToyInfo.prototype,"DlgToyInfo");var InfoItem=function(t){function e(){var e=t.call(this)||this;return e.addChild(e.image=new eui.Image),e.image.y=2,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this;this.image.source=this.data,this.image.once(egret.Event.COMPLETE,function(){t.height=Math.floor(t.image.height*t.width/t.image.width),t.image.height=t.height,t.image.width=t.width},this)},e}(eui.ItemRenderer);__reflect(InfoItem.prototype,"InfoItem");var InviteItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.InviteItem,e.cacheAsBitmap=!0,e.once(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){this.drawBtn.setOnTap(this.draw.bind(this)),this.inviteBtn.setOnTap(this.invite.bind(this))
},e.prototype.dataChanged=function(){var t=this.data;switch(this.taskName.text=t.it_title,this.desc.text="奖励：金币×"+parseInt(t.it_bonus_coin),this.drawBtn.visible=!1,this.finished.visible=!1,this.inviteBtn.visible=!1,t.finished_status){case"0":this.drawBtn.visible=!0;break;case"1":this.finished.visible=!0;break;default:this.inviteBtn.visible=!0}},e.prototype.draw=function(){HttpManager.post(HttpCmd.INVITE_TASK_RECEIVE,{task_id:this.data.it_id,user_id:PlayerDataManager.get(PlayerDataKey.ID)},function(t){PlayerDataManager.updateCoin(),ViewManager.I.doFunc(ViewName.DLG_INVITE,"refresh")},null,!0)},e.prototype.invite=function(){ViewManager.I.doFunc(ViewName.DLG_INVITE,"invite")},e}(eui.ItemRenderer);__reflect(InviteItem.prototype,"InviteItem");var LoginItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.LoginItem,e.cacheAsBitmap=!0,e.once(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){this.drawBtn.setOnTap(this.draw.bind(this))},e.prototype.dataChanged=function(){var t=this.data;this.coinIcon.source=7==parseInt(t.gsd_checkin_total_days)?"ui_json.bag_coin":"ui_json.coin",this.taskName.text=t.gs_gift_name,this.desc.text="奖励：金币×"+parseInt(t.gs_bonus_coin),this.setState(t.status)},e.prototype.setState=function(t){switch(this.drawBtn.visible=!1,this.finished.visible=!1,this.unFinished.visible=!1,t){case-1:this.unFinished.visible=!0;break;case 0:this.drawBtn.visible=!0;break;case 1:this.finished.visible=!0}},e.prototype.draw=function(){var t=this;HttpManager.post(HttpCmd.CHECKIN_RECEIVE,{user_checkin_id:this.data.ucgl_id,user_id:PlayerDataManager.get(PlayerDataKey.ID)},function(e){PlayerDataManager.updateCoin(),t.setState(1)},null,!0)},e}(eui.ItemRenderer);__reflect(LoginItem.prototype,"LoginItem");var NoticeItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.NoticeItem,e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t.msg_title.length>13?this.title.text=t.msg_title.slice(0,12)+"...":this.title.text=t.msg_title,this.content.text=t.msg_desc},e}(eui.ItemRenderer);__reflect(NoticeItem.prototype,"NoticeItem");var OrderItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.OrderItem,e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.toy.text=t.ut_name+"×"+t.pod_toy_num,this.time.text=t.to_createtime},e}(eui.ItemRenderer);__reflect(OrderItem.prototype,"OrderItem");var PickItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.PickItem,e.cacheAsBitmap=!0,e.once(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){this.addBtn.setOnTap(this.add.bind(this)),this.subBtn.setOnTap(this.sub.bind(this))},e.prototype.dataChanged=function(){var t=this.data;this.id=t.id,this.toy.text=DataManager.getToy(this.id).name,this.max=t.count,this.onChange=t.onChange,this.setValue(0)},e.prototype.add=function(){this.setValue(this.cur+1)},e.prototype.sub=function(){this.setValue(this.cur-1)},e.prototype.setValue=function(t){this.cur=Math.max(Math.min(this.max,t),0),this.count.text=""+this.cur,this.addBtn.enabled=this.cur<this.max,this.subBtn.enabled=this.cur>0,this.onChange(this.id,this.cur)},e}(eui.ItemRenderer);__reflect(PickItem.prototype,"PickItem");var RecordItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.RecordItem,e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.nickName.text=t.nickname,this.head.setImage(t.avtar),this.toy.text=t.ut_name,this.time.text=DateUtils.howLongAgo(t.pc_finished_at)},e}(eui.ItemRenderer);__reflect(RecordItem.prototype,"RecordItem");var RoomItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.RoomItem,e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.init=function(){this.icon.mask=this.iconMask,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeRoom,this)},e.prototype.show=function(t){var e=this;this.roomId=t.id,this.toy.text=t.title,this.desc.text=t.cost+"金币/次  约"+t.size+"厘米",this.icon.visible=!1,DisplayUtils.loadImage(t.icon,function(t){e.icon.texture=t,e.icon.visible=!0})},e.prototype.changeRoom=function(){GameConfig.ROOM.changeRoom(this.roomId),ViewManager.I.close(ViewName.DLG_CHOOSE_ROOM)},e.prototype.destroy=function(){DisplayUtils.removeFromParent(this),ObjectPool.push(this)},e}(UIComponent);__reflect(RoomItem.prototype,"RoomItem");var ToyItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.ToyItem,e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.init=function(){this.icon.mask=this.iconMask},e.prototype.show=function(t,e){var i=this;this.roomId=t.id,this.toy.text=t.name+" × "+e,this.icon.visible=!1,DisplayUtils.loadImage(t.icon,function(t){i.icon.texture=t,i.icon.visible=!0})},e.prototype.destroy=function(){DisplayUtils.removeFromParent(this),ObjectPool.push(this)},e}(UIComponent);__reflect(ToyItem.prototype,"ToyItem");var BackupScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.changeRoom=function(t){this.moveScene(ViewManager.I.open(ViewName.GAME,22))},e}(GameScene);__reflect(BackupScene.prototype,"BackupScene");var BulletView=function(t){function e(){var i=t.call(this)||this;return i.noticeList=[],i.bulletList=[],i.interval=30,null==e.datas&&(e.datas=RES.getRes("bullet_json")),i.addChild(i.notice=new GameNotice),i.notice.anchorOffsetX=i.notice.width/2,i.notice.y=10,i.notice.visible=!1,i}return __extends(e,t),e.prototype.start=function(t){this.visible=!0,this.roomId=t,TimerManager.doTimer(200,0,this.update,this)},e.prototype.stop=function(){this.visible=!1,TimerManager.remove(this.update,this)},e.prototype.update=function(){var t=(new Date).getTime(),e=this.interval;if(null==this.lastNotice||t-this.lastNotice>2e3)for(var i=0;i<this.noticeList.length;i++){var n=this.noticeList[i];if(n.user_id!=PlayerDataManager.get(PlayerDataKey.ID)){var a=new Date(DateUtils.convertDate(n.created_at)).getTime();if(t-a>=1e3*e){this.noticeList.splice(i,1),this.addNotice(n),this.lastNotice=t;break}}}for(var i=0;i<this.bulletList.length;i++){var n=this.bulletList[i];if(n.user_id!=PlayerDataManager.get(PlayerDataKey.ID)){var a=new Date(DateUtils.convertDate(n.created_at)).getTime();if(t-a>=1e3*e){this.bulletList.splice(i,1),this.addBullet(n);break}}}this.checkList()},e.prototype.addNotice=function(t){var i=e.datas.suc;this.notice.x=this.width/2;var n;n=null==t.catch_times||t.catch_times>10?ArrayUtils.random(i[0]):i[t.catch_times];var a=n.split("s%"),r=[{text:a[0],style:{}},{text:t.username,style:{bold:!0}},{text:a[1]+t.toy_name+a[2],style:{}}];this.notice.show(t.avtar,r)},e.prototype.addBullet=function(t){var i=e.datas.fail,n=ArrayUtils.random(i),a=n.split("s%");n=a[0]+t.username+a[1]+t.toy_name+a[2];var r=ObjectPool.pop("GameBullet");r.y=200*Math.random()+30,this.addChildAt(r,0);var o=50;r.start(n,this.width+o,-o)},e.prototype.checkList=function(){var t=this,e=(new Date).getTime(),i=this.interval;(null==this.lastTime||e-this.lastTime>=1e3*i)&&(HttpManager.post(HttpCmd.BULLET_SUC,{sec_before:this.interval},function(e){t.noticeList=e.list}),HttpManager.post(HttpCmd.BULLET_FAIL,{sec_before:this.interval,ufo_id:this.roomId},function(e){t.bulletList=e.list}),this.lastTime=e)},e}(eui.Component);__reflect(BulletView.prototype,"BulletView");var FailHint=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){this.pos=this.y},e.prototype.show=function(){var t=this;this.source="wordart_json.fail_hint"+MathUtils.randomInt(1,10),this.visible=!0,this.y=this.pos+200,this.alpha=.3,egret.Tween.removeTweens(this),egret.Tween.get(this).to({y:this.pos,alpha:1},500).wait(2500).to({alpha:0},200).call(function(){t.visible=!1})},e}(eui.Image);__reflect(FailHint.prototype,"FailHint");var FunctionButtons=function(t){function e(){var e=t.call(this)||this;return e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.init=function(){this.bagBtn.setOnTap(function(){return ViewManager.I.open(ViewName.DLG_BAG)}),this.chargeBtn.setOnTap(function(){return ViewManager.I.open(ViewName.DLG_CHARGE)}),this.settingBtn.setOnTap(function(){return ViewManager.I.open(ViewName.DLG_SETTING)}),this.showBtn.setOnTap(function(){return ViewManager.I.open(ViewName.DLG_SHOW)})},e}(UIComponent);__reflect(FunctionButtons.prototype,"FunctionButtons");var GameBullet=function(t){function e(){var e=t.call(this)||this;return e.padding=8,e.addChild(e.bg=new egret.Shape),e.addChild(e.content=new eui.Label),e.content.x=e.content.y=e.padding,e.content.size=24,e}return __extends(e,t),e.prototype.start=function(t,e,i){var n=this;this.content.text=t;var a=this.bg.graphics;a.clear(),a.beginFill(0,.3),a.drawRoundRect(0,0,this.content.width+2*this.padding,this.content.height+2*this.padding,50,50),a.endFill(),this.x=e;var r=5e3+2e3*Math.random();egret.Tween.get(this).to({x:i-this.width},r).call(function(){DisplayUtils.removeFromParent(n),ObjectPool.push(n)})},e}(egret.DisplayObjectContainer);__reflect(GameBullet.prototype,"GameBullet");var GameConfig=function(){function t(){}return t.RANGE_X=190,t.RANGE_Y=95,t.INI_SCALE=1,t}();__reflect(GameConfig.prototype,"GameConfig");var GameNotice=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.GameNotice,e}return __extends(e,t),e.prototype.show=function(t,e){var i=this;this.visible=!0,egret.Tween.removeTweens(this.bg),this.head.setImage(t),this.head.visible=!1,this.content.textFlow=e,this.content.visible=!1,this.bg.width=0,egret.Tween.get(this.bg).to({width:508},300).call(function(){i.content.visible=!0,i.head.visible=!0}).wait(5e3).call(function(){i.visible=!1})},e}(UIComponent);__reflect(GameNotice.prototype,"GameNotice");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function a(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}"undefined"!=typeof generateEUI&&egret.callLater(function(){e.call(n,generateEUI)},this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),DisplayUtils.removeFromParent(this),EgretExpandManager.init();var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/"),this.state=0},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",StageUtils.stage);e.once(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},e.prototype.onThemeLoadComplete=function(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("loading")},e.prototype.onResourceLoadComplete=function(t){if("loading"==t.groupName){var e=window.getParam("user_id");null!=e?LocalDataManager.set(LocalDataKey.ID,e):e=LocalDataManager.get(LocalDataKey.ID),e?(this.loadingScene=ViewManager.I.open(ViewName.LOADING),RES.loadGroup("preload"),this.loadData()):ViewManager.I.open(ViewName.LOGIN)}else"preload"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),WxPlatform.preLoad(),this.nextState(),StageUtils.stage.once(egret.TouchEvent.TOUCH_TAP,function(){SoundManager.I.playMusic("music_mp3")},this))},e.prototype.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingScene&&this.loadingScene.setProgress(t.itemsLoaded/t.itemsTotal)},e.prototype.loadData=function(){var t=this,e=LocalDataManager.get(LocalDataKey.ID),i=4,n=function(){i-=1,0==i&&(DataManager.initRoomToys(),t.nextState())};HttpManager.post(HttpCmd.ROOM_LIST,null,function(t){DataManager.initRoom(t.ufos),n()},null,!0),HttpManager.post(HttpCmd.TOY_LIST,null,function(t){DataManager.initToy(t.toys),n()},null,!0),HttpManager.post(HttpCmd.USER,{user_id:e},function(t){var e=t.result.user;PlayerDataManager.set(PlayerDataKey.ID,e.user_id),PlayerDataManager.set(PlayerDataKey.NAME,e.nickname),PlayerDataManager.set(PlayerDataKey.HEAD,e.avtar),PlayerDataManager.set(PlayerDataKey.PHONE,e.phone),n()},null,!0),HttpManager.post(HttpCmd.USER_CURRENCY,{user_id:e},function(t){PlayerDataManager.set(PlayerDataKey.COIN,parseInt(t.result.uc_balance)),n()})},e.prototype.nextState=function(){this.state+=1,2==this.state&&TimerManager.doTimer(800,1,this.enterGame,this)},e.prototype.enterGame=function(){ViewManager.I.close(ViewName.LOADING),ViewManager.I.open(ViewName.GAME,22),ViewManager.I.open(ViewName.DLG_NOTICE)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var GameTimer=function(t){function e(){var e=t.call(this)||this;return e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.start=function(t,e){void 0===e&&(e=null),this.visible=!0,TimerManager.doTimer(1e3,t,this.countDown,this),this.setCount(t),this.callBack=e},e.prototype.stop=function(){this.visible=!1,TimerManager.remove(this.countDown,this),this.callBack=null},e.prototype.countDown=function(){this.setCount(this.count-1)},e.prototype.setCount=function(t){this.time.text=t+"",this.count=t,0==t&&this.callBack&&this.callBack()},e}(UIComponent);__reflect(GameTimer.prototype,"GameTimer");var GameTips=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.start=function(){this.list=RES.getRes("bullet_json").tips,this.change(),TimerManager.doTimer(5e3,0,this.change,this)},e.prototype.stop=function(){TimerManager.remove(this.change,this)},e.prototype.change=function(){this.text=ArrayUtils.random(this.list)},e}(eui.Label);__reflect(GameTips.prototype,"GameTips");var GiftButtons=function(t){function e(){var e=t.call(this)||this;return e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.init=function(){var t=this;this.dailyTaskBtn.setOnTap(function(){ViewManager.I.open(ViewName.DLG_DAILY_TASK)}),this.dailyGiftBtn.setOnTap(function(){ViewManager.I.open(ViewName.DLG_DAILY_GIFT)}),this.inviteBtn.setOnTap(function(){ViewManager.I.open(ViewName.DLG_INVITE)}),this.bindBtn.setOnTap(function(){ViewManager.I.open(ViewName.DLG_BIND)}),PlayerDataManager.addDataListener(PlayerDataKey.PHONE,function(e){t.checkPhone(e)}),this.checkPhone(PlayerDataManager.get(PlayerDataKey.PHONE))},e.prototype.checkPhone=function(t){t&&DisplayUtils.removeFromParent(this.bindBtn.parent)},e}(UIComponent);__reflect(GiftButtons.prototype,"GiftButtons");var Hand=function(t){function e(){var e=t.call(this)||this;e.skinName=skins.Hand,AnchorUtils.setAnchorX(e,.5);var i=e.shadow.graphics;return i.clear(),i.beginFill(0,.25),i.drawEllipse(0,0,160,45),i.endFill(),AnchorUtils.setAnchor(e.shadow,.5),e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.length=0},e.prototype.changeLength=function(t,e){void 0===e&&(e=null);var i,n=t-this.length;i=n>0?3*n:5*-n,egret.Tween.get(this).to({length:t},i).call(function(){e&&e()})},e.prototype.shrink=function(){var t=this;egret.Tween.removeTweens(this.leftHand),egret.Tween.removeTweens(this.rightHand),this.leftReady=!1,this.rightReady=!1;var e=5*Math.abs(this.leftHand.rotation-50);egret.Tween.get(this.leftHand).to({rotation:-50},e).call(function(){t.leftReady=!0},this);var i=5*Math.abs(this.rightHand.rotation-50);egret.Tween.get(this.rightHand).to({rotation:50},i).call(function(){t.rightReady=!0},this)},e.prototype.spread=function(){var t=this;egret.Tween.removeTweens(this.leftHand),egret.Tween.removeTweens(this.rightHand);var e=8*Math.abs(this.leftHand.rotation);egret.Tween.get(this.leftHand).to({rotation:0},e).call(function(){t.leftReady=!0},this);var i=8*Math.abs(this.rightHand.rotation);egret.Tween.get(this.rightHand).to({rotation:0},i).call(function(){t.rightReady=!0},this)},e.prototype.checkHit=function(t){if(t){if(!this.leftReady){var e=this.leftRect.height,i=this.leftRect.localToGlobal(),n=this.leftRect.rotation+this.leftHand.rotation,a=new Vector2(i.x,i.y),r=new Vector2(i.x+Math.sin((n-180)/180*Math.PI)*e,i.y-Math.cos((n-180)/180*Math.PI)*e);MathUtils.lineRectIntersection(a,r,t)&&(this.leftReady=!0,egret.Tween.removeTweens(this.leftHand))}if(!this.rightReady){var e=this.rightRect.height,i=this.rightRect.localToGlobal(),n=-this.rightRect.rotation+this.rightHand.rotation,a=new Vector2(i.x,i.y),r=new Vector2(i.x+Math.sin((n-180)/180*Math.PI)*e,i.y-Math.cos((n-180)/180*Math.PI)*e);MathUtils.lineRectIntersection(a,r,t)&&(this.rightReady=!0,egret.Tween.removeTweens(this.rightHand))}}return this.leftReady&&this.rightReady},e.prototype.redress=function(){egret.Tween.removeTweens(this.leftHand),egret.Tween.removeTweens(this.rightHand);var t=-this.leftHand.rotation+this.rightHand.rotation,e=30*Math.abs(t/2-this.rightHand.rotation);egret.Tween.get(this.leftHand).to({rotation:-t/2},e),egret.Tween.get(this.rightHand).to({rotation:t/2},e)},e.prototype.shake=function(t){var e=20*t;egret.Tween.removeTweens(this.root),egret.Tween.get(this.root,{loop:!0}).to({rotation:e},400).wait(100).to({rotation:-e},800).wait(100).to({rotation:0},400)},e.prototype.stopShake=function(){egret.Tween.removeTweens(this.root),egret.Tween.get(this.root).to({rotation:0},200)},Object.defineProperty(e.prototype,"vy",{get:function(){return this._vy},set:function(t){this._vy=t,this.shadow.y=this._vy;var e=GameConfig.RANGE_Y,i=GameConfig.INI_SCALE;this.scaleX=this.scaleY=this.shadow.scaleX=this.shadow.scaleY=i+this._vy/e*.05},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vz",{get:function(){return this._vz},set:function(t){this._vz=t,this.y=-this._vz},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._length},set:function(t){this._length=t,this.line.height=this.root.y=90+this._length},enumerable:!0,configurable:!0}),e}(GameObject);__reflect(Hand.prototype,"Hand");var Lamp=function(t){function e(){var e=t.call(this)||this;return e.flag=!0,e}return __extends(e,t),e.prototype.start=function(){TimerManager.doTimer(600,0,this.change,this)},e.prototype.stop=function(){TimerManager.remove(this.change,this)},e.prototype.change=function(){this.flag=!this.flag,this.img.texture=RES.getRes("game_json.light_"+(this.flag?"1":"2"))},e}(UIComponent);__reflect(Lamp.prototype,"Lamp");var LuckyBar=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.bar.parent.addChild(this.barMask=new egret.Shape);var t=this.barMask.graphics;t.beginFill(0),t.drawRect(0,0,this.bar.width,this.bar.height),t.endFill(),this.barMask.y=this.bar.y,this.barMask.x=this.bar.x-this.bar.width,this.bar.mask=this.barMask},e.prototype.start=function(t){var e=this;this.luckyValue=0,HttpManager.post(HttpCmd.LUCKY_SCORE,{user_id:PlayerDataManager.get(PlayerDataKey.ID),ufo_id:t},function(t){e.setLucky(t.result.userLuckyScore)},null,!0)},e.prototype.setLucky=function(t){var e=500;egret.Tween.removeTweens(this),egret.Tween.get(this).to({luckyValue:t},e)},Object.defineProperty(e.prototype,"value",{get:function(){return this.luckyValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"luckyValue",{get:function(){return this._luckyValue},set:function(t){this._luckyValue=t,this.lucky.text=Math.floor(t)+"",this.barMask.x=this.bar.x+this.bar.width*(t/100-1)},enumerable:!0,configurable:!0}),e}(UIComponent);__reflect(LuckyBar.prototype,"LuckyBar");var LuckyHint=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.show=function(t,e){var i=this;this.luckyFull.visible=t,this.luckyAdd.visible=!t;var n="+"+e;this.luckyAdd.text=n,this.visible=!0,this.scaleX=this.scaleY=.01,this.alpha=1,egret.Tween.removeTweens(this),egret.Tween.get(this).to({scaleX:1,scaleY:1},300).wait(2500).to({alpha:0},200).call(function(){i.visible=!1})},e}(UIComponent);__reflect(LuckyHint.prototype,"LuckyHint");var RoomUsers=function(t){function e(){var e=t.call(this)||this;return e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.start=function(t){this.room=t,this.getUsers(),TimerManager.doTimer(2e4,0,this.getUsers,this)},e.prototype.stop=function(){TimerManager.remove(this.getUsers,this)},e.prototype.getUsers=function(){var t=this;HttpManager.post(HttpCmd.ROOM_USERS,{ufo_id:this.room},function(e){t.userCnt.text=e.result.count+"人";for(var i=e.result.users,n=0;4>n;n++){var a=ArrayUtils.random(i);if(null==a)break;var r=t.headGroup.getChildAt(n);r.setImage(a.avtar),ArrayUtils.remove(i,a)}})},e}(UIComponent);__reflect(RoomUsers.prototype,"RoomUsers");var Toy=function(t){function e(){var e=t.call(this)||this;return e.addChild(e.image=new egret.Bitmap),e.addChild(e.emoji=new egret.Bitmap),e}return __extends(e,t),e.prototype.init=function(e){t.prototype.init.call(this),this.shadow.graphics.clear(),this.data=e,this.vx=e.x,this.vy=e.y,this.vz=0,this.alpha=1,DisplayUtils.loadImage(e.img,this.onLoaded.bind(this)),this.image.scaleX=this.image.scaleY=1,this.emoji.visible=!1},e.prototype.homing=function(){var t=this,e=50*Math.sqrt(this.vz);egret.Tween.get(this).to({vz:0},e,egret.Ease.quadIn),egret.Tween.get(this).to({vx:this.data.x,vy:this.data.y},e).call(function(){e>300&&egret.Tween.get(t.image).to({scaleX:1,scaleY:.95},120,egret.Ease.bounceInOut).to({scaleX:1,scaleY:1},180,egret.Ease.bounceInOut)})},e.prototype.showEmoji=function(t){var e,i=this;switch(t){case 0:e="game_json.em_stay"+MathUtils.randomInt(1,9);break;case 1:e="game_json.em_down"+MathUtils.randomInt(1,5);break;case 2:e="game_json.em_up"+MathUtils.randomInt(1,5)}this.emoji.texture=RES.getRes(e),AnchorUtils.setAnchorX(this.emoji,.2),AnchorUtils.setAnchorY(this.emoji,1),this.emoji.visible=!0,egret.Tween.removeTweens(this.emoji),this.emoji.alpha=1,this.emoji.x=18,this.emoji.y=.65*-this.image.height,this.emoji.scaleX=this.emoji.scaleY=.01,egret.Tween.get(this.emoji).to({scaleX:1,scaleY:1},400,egret.Ease.backOut).wait(3e3).to({alpha:0},200).call(function(){i.emoji.visible=!1})},e.prototype.onLoaded=function(t){this.image.texture=t,AnchorUtils.setAnchorX(this.image,.5),AnchorUtils.setAnchorY(this.image,1);var e=this.shadow.graphics;e.clear(),e.beginFill(0,.2),e.drawEllipse(0,0,.8*this.image.width,32),e.endFill(),AnchorUtils.setAnchor(this.shadow,.5)},Object.defineProperty(e.prototype,"id",{get:function(){return this.data.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dollName",{get:function(){return this.data.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vh",{get:function(){return this.data.h},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vw",{get:function(){return this.data.w},enumerable:!0,configurable:!0}),e}(GameObject);__reflect(Toy.prototype,"Toy");var ToyWorld=function(t){function e(){var e=t.call(this)||this;return e.objects=[],e.toyDic={},e.maxSpeed=.2,e.acc=.001,e}return __extends(e,t),e.prototype.createChildren=function(){this.addObj(this.hand=ObjectPool.pop("Hand")),this.hand.init(),this.game=this.parent},e.prototype.init=function(){this.hand.vx=-GameConfig.RANGE_X,this.hand.vy=0,this.hand.vz=600,this.clearToy(),TimerManager.doTimer(5e3,0,this.showEmoji,this)},e.prototype.showToy=function(t){for(var e=0;e<t.length;e++){var i=t[e],n=ObjectPool.pop("Toy");n.init(i),this.toyDic[i.idx]=n,this.addObj(n)}this.sortObjects()},e.prototype.clearToy=function(){for(var t in this.toyDic)this.removeObj(this.toyDic[t]);this.toyDic={}},e.prototype.showEmoji=function(){var t=[];for(var e in this.toyDic)t.push(e);t.length>1&&t.indexOf(this.lastEmoji)>=0&&ArrayUtils.remove(t,this.lastEmoji),this.lastEmoji=ArrayUtils.random(t);var i=this.toyDic[this.lastEmoji];i&&i.showEmoji(0)},e.prototype.start=function(){this.state=0,this.speed=0,this.direction=null,TimerManager.doFrame(1,0,this.update,this),TimerManager.remove(this.showEmoji,this),this.curTime=egret.getTimer()},e.prototype.end=function(){TimerManager.remove(this.update,this),TimerManager.doTimer(5e3,0,this.showEmoji,this)},e.prototype.setDirection=function(t){if(0==this.state){switch(this.direction=t,t){case Direction.UP:case Direction.DOWN:break;case Direction.LEFT:this.hand.shake(-1);break;case Direction.RIGHT:this.hand.shake(1);break;default:this.speed=0,this.hand.stopShake()}t?this.playMoveSound():this.stopMoveSound()}},e.prototype.playMoveSound=function(){this.moveSound&&this.moveSound.stop(),this.moveSound=SoundManager.I.playEffect("move_mp3",1),this.moveSound.addEventListener(egret.Event.SOUND_COMPLETE,this.playMoveSound,this)},e.prototype.stopMoveSound=function(){this.moveSound&&(this.moveSound.removeEventListener(egret.Event.SOUND_COMPLETE,this.playMoveSound,this),this.moveSound.stop(),SoundManager.I.removeEffect(this.moveSound))},e.prototype.startCatch=function(){if(0==this.state){this.state=1,this.sortObjects();var t,e,i=this.hand;for(var n in this.toyDic){var a=this.toyDic[n],r=MathUtils.cacuDistance(i.vx,i.vy,a.vx,a.vy);(null==t||t>r)&&(e=a,t=r)}if(e&&(Math.abs(i.vx-e.vx)>50||Math.abs(i.vy-e.vy)>30)&&(e=null),this.target=e,e){var o=e.getBounds(),s=e.localToGlobal(),h=e.vw,c=e.vh,l=(o.width-h)/2,u=o.height-c;this.targetRect=new Rect(s.x+o.x+l,s.y+o.y+u,h,c)}else this.targetRect=null;return this.result=0,this.moveHandDown(),this.stopMoveSound(),this.hand.stopShake(),this.target}},e.prototype.setResult=function(t){this.result=t?1:-1,this.lostPos=200*Math.random()+30},e.prototype.update=function(){var t=egret.getTimer(),e=t-this.curTime;switch(this.curTime=t,this.state){case 0:this.direction&&this.move(e);break;case 2:this.hand.checkHit(this.targetRect)&&(this.state=3,this.target&&this.hand.redress(),this.moveHandUp());break;case 3:if(this.target){var i=Math.max(Math.min(1,this.hand.vx-this.target.vx),-1);this.target.vx+=i,this.target.vz=(this.handLen-this.hand.length)*this.hand.scaleY,-1==this.result&&this.target.vz>=this.lostPos&&this.lostDoll()}break;case 4:if(this.target){this.target.vx=this.hand.vx;var n=this.hand.vy-this.target.vy,a=this.target.scaleY;this.target.vy+=n;var r=this.target.scaleY;this.target.vz+=n-(r-a)*(this.target.getBounds().height+.7*this.hand.getBounds().height)}}},e.prototype.move=function(t){switch(this.direction){case Direction.UP:this.hand.vy-=.15*t;break;case Direction.DOWN:this.hand.vy+=.15*t;break;case Direction.LEFT:this.speed=Math.max(this.speed-this.acc*t,-this.maxSpeed),this.hand.vx+=this.speed*t;break;case Direction.RIGHT:this.speed=Math.min(this.speed+this.acc*t,this.maxSpeed),this.hand.vx+=this.speed*t}var e=GameConfig.RANGE_X,i=GameConfig.RANGE_Y;this.hand.vx=Math.max(Math.min(e,this.hand.vx),-e),this.hand.vy=Math.max(Math.min(i,this.hand.vy),-i)},e.prototype.moveHandDown=function(){var t=this,e=this.hand.vy;if(this.target){e=this.target.vy;var i=this.getChildIndex(this.target),n=this.getChildIndex(this.hand);n>i&&this.setChildIndex(this.hand,i)}var a=GameConfig.INI_SCALE,r=390-(this.target?this.target.vh:130);this.handLen=(e-270*(this.hand.scaleY-a)+r)*a/this.hand.scaleY,this.hand.changeLength(this.handLen,function(){t.state=2,t.hand.shrink(),window.t=t.target})},e.prototype.moveHandUp=function(){var t=this;this.target&&this.target.showEmoji(2),this.hand.changeLength(0,function(){t.target&&t.result<=0&&t.lostDoll(),t.toAward()})},e.prototype.lostDoll=function(){this.hand.shrink();var t=this.target;SoundManager.I.playEffect("fail_mp3"),egret.setTimeout(function(){t.homing(),t.showEmoji(1)},this,60),this.target=null},e.prototype.toAward=function(){var t=this;this.state=4;var e=-GameConfig.RANGE_X,i=GameConfig.RANGE_Y,n=Math.max(5*Math.abs(.9*e-this.hand.vx),5*Math.abs(.9*i-this.hand.vy));egret.Tween.get(this.hand).to({vx:.9*e,vy:.9*i},n).call(function(){t.state=5,t.hand.spread(),t.target&&t.getAward()}).wait(600).call(function(){t.end(),t.game.end()}).to({vx:e,vy:0},600)},e.prototype.getAward=function(){var t=this;this.game.awardCon.addChild(this.target);var e=50*Math.sqrt(this.target.vz);egret.Tween.get(this.target).to({vz:0},e,egret.Ease.quadIn).to({alpha:0},300).call(function(){t.target.alpha=0,t.removeObj(t.target)})},e.prototype.addObj=function(t){t.addTo(this),this.objects.push(t)},e.prototype.removeObj=function(t){ArrayUtils.remove(this.objects,t),t.destroy(),ObjectPool.push(t)},e.prototype.sortObjects=function(){var t=this;this.objects.sort(this.sort),this.objects.forEach(function(e){t.setChildIndex(e,t.numChildren+1)})},e.prototype.sort=function(t,e){return t.vy-e.vy},e}(eui.Component);__reflect(ToyWorld.prototype,"ToyWorld");var UserInfo=function(t){function e(){var e=t.call(this)||this;return e.cacheAsBitmap=!0,e}return __extends(e,t),e.prototype.init=function(){var t=this;this.nickName.text=PlayerDataManager.get(PlayerDataKey.NAME),this.coin.text=PlayerDataManager.get(PlayerDataKey.COIN),PlayerDataManager.addDataListener(PlayerDataKey.COIN,function(e){t.coin.text=e})},e}(UIComponent);__reflect(UserInfo.prototype,"UserInfo");var HttpCmd=function(){function t(){}return t.CATCH_START="/Home/Catch/insertCoin",t.CATCH_LOST="/Home/Catch/lost",t.CATCH_FAIL="/Home/Catch/failure",t.CATCH_SUC="/Home/Catch/success",t.BAG_LIST="/Home/Backpack/getAll",t.ORDER_LIST="/Home/ToyOrder/getAll",t.BULLET_SUC="/Home/CatchDanmu/getCatched",t.BULLET_FAIL="/Home/CatchDanmu/getUncatchedRecords",t.MESSAGE_LIST="/Home/Message/getAll",t.DAILY_TASK_LIST="/Home/DailyMission/getUserMission",t.ROOM_USERS="/Home/Online/getRoomUsers",t.CATCH_RECORD_LIST="/Home/ListCatched/pagination",t.DAILY_TASK_RECEIVE="/Home/DailyMission/receiveBonus",t.CHECKIN_LIST="/Home/Checkin/history",t.CHECKIN_RECEIVE="/Home/Checkin/getBonus",t.CHARGE_LIST="/Home/Payment/getSettings",t.LUCKY_SCORE="/Home/Online/getLuckyScore",t.ROOM_LIST="/Home/UfoCatcher/getUfos",t.TOY_LIST="/Home/UfoCatcher/getToys",t.BULLET_LIST="/Home/UfoCatcher/getSlogans",t.USER_CURRENCY="/Home/Currency/getUserCurrency",t.USER="/Home/User/getUser",t.EXCHANGE="/Home/Backpack/exchange",t.DAILY_GIFT_RECEIVE="/Home/WechatDailyGift/receive",t.INVITE_TASK_LIST="/Home/InviteTask/getAll",t.INVITE_TASK_RECEIVE="/Home/InviteTask/finish",t.SHARE_RECEIVE="/Home/InviteShareTask/share",t.SEND_CODE="/Home/User/sendCode",t.BIND_PHONE="/Home/User/bindPhone",t.LOGIN_QQ="/Service/Qq/login",t.PAY="/Home/Payment/pay",t}();__reflect(HttpCmd.prototype,"HttpCmd");var HttpLoading=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.addChild(this.black=new egret.Shape),this.addChild(this.con=new egret.DisplayObjectContainer),this.con.addChild(this.bg=new egret.Shape),this.con.addChild(this.round=new egret.Shape),this.con.addChild(this.label=new eui.Label);var t=this.bg.graphics;t.beginFill(0,.8),t.drawRoundRect(-100,-100,200,200,20),t.endFill();var e=this.round.graphics;e.lineStyle(12,16777215),e.drawArc(0,0,40,0,1.6*Math.PI),e.endFill(),this.round.y=-20,this.label.text="加载中...",this.label.width=200,this.label.anchorOffsetX=100,this.label.textAlign="center",this.label.y=40,this.black.touchEnabled=!0},e.prototype.show=function(){var t=this;egret.Tween.removeTweens(this.round),this.round.rotation=0,egret.Tween.get(this.round,{loop:!0}).to({rotation:360},1e3),this.con.visible=!1,egret.setTimeout(function(){t.con.visible=!0},this,250)},e.prototype.onResize=function(){var t=StageUtils.stage,e=t.stageWidth,i=t.stageHeight,n=this.black.graphics;n.beginFill(0,.01),n.drawRect(0,0,e,i),n.endFill(),this.con.x=e/2,this.con.y=i/2*.9},e.prototype.close=function(){t.prototype.close.call(this),egret.Tween.removeTweens(this.round)},e}(PopWin);__reflect(HttpLoading.prototype,"HttpLoading");var HttpManager=function(){function t(){}return t.get=function(t,e,i,n,a){void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=!1),this.send(egret.HttpMethod.GET,t,e,i,n,a)
},t.post=function(t,e,i,n,a){void 0===i&&(i=null),void 0===n&&(n=null),void 0===a&&(a=!1),this.send(egret.HttpMethod.POST,t,e,i,n,a)},t.send=function(t,e,i,n,a,r){var o=this;void 0===n&&(n=null),void 0===a&&(a=null),void 0===r&&(r=!1),r&&null==a&&(a=this.fail.bind(this)),r&&this.showLoading();var s=new egret.HttpRequest,h=Config.server+e,c=0,l="";for(var u in i)l+=0==c?"":"&",l+=u+"="+i[u],c+=1;switch(s.responseType=egret.HttpResponseType.TEXT,t){case egret.HttpMethod.GET:s.open(h,t),h+="?"+l,s.withCredentials=!0,s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send();break;case egret.HttpMethod.POST:s.open(h,t),s.withCredentials=!0,s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(l)}s.addEventListener(egret.Event.COMPLETE,function(t){var e=JSON.parse(t.currentTarget.response);0==e.error?n&&n(e):a&&a(e),r&&o.hideLoading()},this),s.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){a&&a(),r&&o.hideLoading()},this)},t.fail=function(t){console.log(t),ViewManager.I.open(ViewName.POP_ALERT,t.message)},t.showLoading=function(){0==this.loadCnt&&ViewManager.I.open(ViewName.HTTP),this.loadCnt+=1},t.hideLoading=function(){this.loadCnt-=1,0==this.loadCnt&&ViewManager.I.close(ViewName.HTTP)},t.loadCnt=0,t}();__reflect(HttpManager.prototype,"HttpManager");var LoadingScene=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.LoadingScene,e}return __extends(e,t),e.prototype.init=function(){this.addChild(this.barMask=new egret.Shape);var t=this.barMask.graphics;t.beginFill(0),t.drawRect(0,-10,this.bar.width,this.bar.height+20),t.endFill(),this.barMask.y=this.bar.y,this.barMask.x=this.bar.x-this.bar.width,this.bar.mask=this.barMask,this._per=0},e.prototype.setProgress=function(t){var e=500;egret.Tween.removeTweens(this),egret.Tween.get(this).to({per:t},e)},Object.defineProperty(e.prototype,"per",{get:function(){return this._per},set:function(t){this._per=t,this.progress.text=Math.floor(100*t)+"%",this.barMask.x=this.bar.x+this.bar.width*(t-1)},enumerable:!0,configurable:!0}),e}(Scene);__reflect(LoadingScene.prototype,"LoadingScene");var LoginScene=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.LoginScene,e}return __extends(e,t),e.prototype.init=function(){this.qqBtn.setOnTap(this.qqLogin.bind(this)),this.wxBtn.setOnTap(this.wxLogin.bind(this))},e.prototype.qqLogin=function(){QQPlatform.login()},e.prototype.wxLogin=function(){},e}(Scene);__reflect(LoginScene.prototype,"LoginScene");var AliPlatform=function(){function t(){}return t.pay=function(t){var e=Config.server+HttpCmd.PAY+"?user_id="+PlayerDataManager.get(PlayerDataKey.ID)+"&pay_channel=4&pay_id="+t;window.jump(e)},t}();__reflect(AliPlatform.prototype,"AliPlatform");var QQPlatform=function(){function t(){}return t.login=function(){var t=Config.server+HttpCmd.LOGIN_QQ;window.jump(t)},t}();__reflect(QQPlatform.prototype,"QQPlatform");var WxPlatform=function(){function t(){}return t.prototype.login=function(){},t.pay=function(t){var e=Config.server+HttpCmd.PAY+"?user_id="+PlayerDataManager.get(PlayerDataKey.ID)+"&pay_channel=5&pay_id="+t;window.jump(e)},t.share=function(t,e){window.showQrcode(ArrayUtils.random(this.QR_ARR))},t.createQrcode=function(){var t=qr.QRCode.create(Config.auth+"?inviter="+PlayerDataManager.get(PlayerDataKey.ID)),e=new egret.RenderTexture;e.drawToTexture(t);var i=new egret.Bitmap;return i.texture=e,i},t.preLoad=function(){var t=[[340,607,260,260],[229,679,260,260],[42,738,260,260]];this.QR_ARR=[];for(var e=0;e<t.length;e++){var i=new egret.Sprite,n=DisplayUtils.createBitmap("share_"+(e+1)+"_png"),a=this.createQrcode(),r=t[e];a.x=r[0],a.y=r[1],a.width=r[2],a.height=r[3],i.addChild(n),i.addChild(a);var o=new egret.RenderTexture;o.drawToTexture(i),this.QR_ARR[e]=o.toDataURL("image/png",new egret.Rectangle(0,0,i.width,i.height)),window.showQrcode(this.QR_ARR[e])}window.hideQrcode()},t.QR_ARR=[],t}();__reflect(WxPlatform.prototype,"WxPlatform");var EgretExpandManager=function(){function t(){}return t.init=function(){AnchorUtils.init(),TimerManager.init(),StageUtils.stage.addEventListener(egret.Event.ACTIVATE,function(){TimerManager.setTimeScale(1),SoundManager.I.resume()},this),StageUtils.stage.addEventListener(egret.Event.DEACTIVATE,function(){TimerManager.setTimeScale(0),SoundManager.I.pause()},this)},t}();__reflect(EgretExpandManager.prototype,"EgretExpandManager");var LocalDataManager=function(){function t(){}return t.set=function(t,e){null==this.data&&this.load(),this.data[t]=e,this.listener[t]&&this.listener[t].forEach(function(t){t(e)}),this.save()},t.get=function(t){return null==this.data&&this.load(),this.data[t]},t.addDataListener=function(t,e){this.listener[t]||(this.listener[t]=[]),this.listener[t].push(e)},t.removeDataListener=function(t,e){this.listener[t]&&ArrayUtils.remove(this.listener[t],e)},t.load=function(){var t=egret.localStorage.getItem("tom_toy_loc");t?this.data=JSON.parse(t):(this.data={},this.data[LocalDataKey.ID]=null,this.data[LocalDataKey.SOUND]=!0,this.data[LocalDataKey.BULLET]=!0,this.data[LocalDataKey.GUIDE]=0,this.data[LocalDataKey.ADDRESS]={},this.data[LocalDataKey.SHARE]=!1)},t.save=function(){egret.localStorage.setItem("tom_toy_loc",JSON.stringify(this.data))},t.listener=[],t}();__reflect(LocalDataManager.prototype,"LocalDataManager");var LocalDataKey;!function(t){t[t.ID=0]="ID",t[t.SOUND=1]="SOUND",t[t.BULLET=2]="BULLET",t[t.GUIDE=3]="GUIDE",t[t.ADDRESS=4]="ADDRESS",t[t.SHARE=5]="SHARE"}(LocalDataKey||(LocalDataKey={}));var PlayerDataManager=function(){function t(){}return t.set=function(t,e){this.data[t]=e,this.listener[t]&&this.listener[t].forEach(function(t){t(e)})},t.get=function(t){return this.data[t]},t.addDataListener=function(t,e){this.listener[t]||(this.listener[t]=[]),this.listener[t].push(e)},t.removeDataListener=function(t,e){this.listener[t]&&ArrayUtils.remove(this.listener[t],e)},t.updateCoin=function(){var e=this;HttpManager.post(HttpCmd.USER_CURRENCY,{user_id:this.get(PlayerDataKey.ID)},function(i){var n=parseInt(i.result.uc_balance),a=n-e.get(PlayerDataKey.COIN);t.set(PlayerDataKey.COIN,n),a>0&&ViewManager.I.open(ViewName.POP_HINT,"获得金币×"+a)})},t.data={},t.listener=[],t}();__reflect(PlayerDataManager.prototype,"PlayerDataManager");var PlayerDataKey;!function(t){t[t.ID=0]="ID",t[t.NAME=1]="NAME",t[t.HEAD=2]="HEAD",t[t.COIN=3]="COIN",t[t.PHONE=4]="PHONE"}(PlayerDataKey||(PlayerDataKey={}));var SoundManager=function(){function t(){var e=this;this.soundDic={},this.effectArr=[],this.pauseCnt=0;var i=LocalDataManager.get(LocalDataKey.SOUND);this.setMusicVolum(i?t.MV:0),this.setEffectVolum(i?t.EV:0),LocalDataManager.addDataListener(LocalDataKey.SOUND,function(i){e.setMusicVolum(i?t.MV:0),e.setEffectVolum(i?t.EV:0)})}return Object.defineProperty(t,"I",{get:function(){return this._instance||(this._instance=new t)},enumerable:!0,configurable:!0}),t.prototype.playMusic=function(t){this.stopMusic(),this.pausePoint=null,this.musicSound=this.getSound(t),this.musicSound&&(this.musicSound.type=egret.Sound.MUSIC,this.music=this.musicSound.play(0,0),this.music.volume=this.musicVolum)},t.prototype.pauseMusic=function(){this.music&&(this.pausePoint=this.music.position,this.music.stop(),this.music=null)},t.prototype.resumeMusic=function(){if(this.musicSound){var t=this.pausePoint||0;this.music=this.musicSound.play(t),this.music.volume=this.musicVolum,this.pausePoint=null}},t.prototype.stopMusic=function(){this.music&&(this.music.stop(),this.music=null)},t.prototype.playEffect=function(t,e){var i=this;void 0===e&&(e=0);var n=this.getSound(t,e);if(n){n.type=egret.Sound.EFFECT;var a=n.play(0,1);return a.volume=this.effectVolum,this.effectArr.push(a),a.addEventListener(egret.Event.SOUND_COMPLETE,function(){i.removeEffect(a)},this),a}},t.prototype.setMusicVolum=function(t){this.musicVolum=t,this.music&&(this.music.volume=t)},t.prototype.setEffectVolum=function(t){this.effectVolum=t;for(var e=0;e<this.effectArr.length;e++)this.effectArr[e].volume=t},t.prototype.removeEffect=function(t){ArrayUtils.remove(this.effectArr,t)},t.prototype.getSound=function(t,e){void 0===e&&(e=0);var i=this.soundDic[t],n=egret.getTimer();if(i){if(n-i[1]<e)return null}else{var a=RES.getRes(t);i=[a,n],this.soundDic[t]=i}return i[1]=n,i[0]},t.prototype.pause=function(){this.pauseCnt+=1,this.setMusicVolum(0),this.setEffectVolum(0)},t.prototype.resume=function(){if(this.pauseCnt-=1,this.pauseCnt<=0){this.pauseCnt=0;var t=LocalDataManager.get(LocalDataKey.SOUND)?1:0;this.setMusicVolum(t),this.setEffectVolum(t)}},t._instance=null,t.MV=.4,t.EV=1,t}();__reflect(SoundManager.prototype,"SoundManager");var PopAlert=function(t){function e(){var e=t.call(this)||this;return e.layer=Layer.POPWIN,e.skinName=skins.PopAlert,e}return __extends(e,t),e.prototype.init=function(){var e=this;this.cacheAsBitmap=!0,this.btn.setOnTap(function(){e.close(),e.callBack&&e.callBack()}),t.prototype.init.call(this)},e.prototype.preOpen=function(e,i,n){void 0===i&&(i=null),void 0===n&&(n=null),t.prototype.preOpen.call(this),null==i&&(i="确定"),this.content.text=e,this.btn.labelDisplay.text=i,this.callBack=n},e}(Dialog);__reflect(PopAlert.prototype,"PopAlert");var PopHint=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.PopHint,e}return __extends(e,t),e.prototype.preOpen=function(e){this.content.text=e,t.prototype.preOpen.call(this)},e.prototype.show=function(){var t=this;StageUtils.stage.addChild(this),egret.Tween.removeTweens(this.con),this.con.alpha=0,egret.Tween.get(this.con).to({alpha:1},200).wait(1500).to({alpha:0},200).call(function(){DisplayUtils.removeFromParent(t)})},e}(PopWin);__reflect(PopHint.prototype,"PopHint");var qr;!function(t){var e=function(){function e(e){this.mode=t.QRMode.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var i=0,n=this.data.length;n>i;i++){var a=[],r=this.data.charCodeAt(i);r>65536?(a[0]=240|(1835008&r)>>>18,a[1]=128|(258048&r)>>>12,a[2]=128|(4032&r)>>>6,a[3]=128|63&r):r>2048?(a[0]=224|(61440&r)>>>12,a[1]=128|(4032&r)>>>6,a[2]=128|63&r):r>128?(a[0]=192|(1984&r)>>>6,a[1]=128|63&r):a[0]=r,this.parsedData.push(a)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return e.prototype.getLength=function(t){return this.parsedData.length},e.prototype.write=function(t){for(var e=0,i=this.parsedData.length;i>e;e++)t.put(this.parsedData[e],8)},e}();t.QR8bitByte=e,__reflect(e.prototype,"qr.QR8bitByte")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){this.buffer=[],this.length=0}return t.prototype.get=function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},t.prototype.put=function(t,e){for(var i=0;e>i;i++)this.putBit(1==(t>>>e-i-1&1))},t.prototype.getLengthInBits=function(){return this.length},t.prototype.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++},t}();t.QRBitBuffer=e,__reflect(e.prototype,"qr.QRBitBuffer")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.create=function(i,n,a,r,o){void 0===n&&(n=0),void 0===a&&(a=200),void 0===r&&(r=200),void 0===o&&(o=2);var s={width:a,height:r,correctLevel:t.QRErrorCorrectLevel.H,color:n},h=new t.QRCodeModel(t.QRUtil._getTypeNumber(i,s.correctLevel),s.correctLevel);return h.addData(i),h.make(),e.draw(h,s)},e.draw=function(t,e){for(var i=new egret.Sprite,e=e,n=t.getModuleCount(),a=Math.floor(e.width/n),r=Math.floor(e.height/n),o=0;n>o;o++)for(var s=0;n>s;s++){var h=t.isDark(o,s);h&&(i.graphics.beginFill(e.color),i.graphics.drawRect(s*a,o*r,a,r),i.graphics.endFill())}return i},e}();t.QRCode=e,__reflect(e.prototype,"qr.QRCode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}return e.prototype.addData=function(e){var i=new t.QR8bitByte(e);this.dataList.push(i),this.dataCache=null},e.prototype.isDark=function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},e.prototype.getModuleCount=function(){return this.moduleCount},e.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},e.prototype.makeImpl=function(t,i){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++){this.modules[n]=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++)this.modules[n][a]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,i),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,i)},e.prototype.setupPositionProbePattern=function(t,e){for(var i=-1;7>=i;i++)if(!(-1>=t+i||this.moduleCount<=t+i))for(var n=-1;7>=n;n++)-1>=e+n||this.moduleCount<=e+n||(i>=0&&6>=i&&(0==n||6==n)||n>=0&&6>=n&&(0==i||6==i)||i>=2&&4>=i&&n>=2&&4>=n?this.modules[t+i][e+n]=!0:this.modules[t+i][e+n]=!1)},e.prototype.getBestMaskPattern=function(){for(var e=0,i=0,n=0;8>n;n++){this.makeImpl(!0,n);var a=t.QRUtil.getLostPoint(this);(0==n||e>a)&&(e=a,i=n)}return i},e.prototype.createMovieClip=function(t,e,i){var n=t.createEmptyMovieClip(e,i),a=1;this.make();for(var r=0;r<this.modules.length;r++)for(var o=r*a,s=0;s<this.modules[r].length;s++){var h=s*a,c=this.modules[r][s];c&&(n.beginFill(0,100),n.moveTo(h,o),n.lineTo(h+a,o),n.lineTo(h+a,o+a),n.lineTo(h,o+a),n.endFill())}return n},e.prototype.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},e.prototype.setupPositionAdjustPattern=function(){for(var e=t.QRUtil.getPatternPosition(this.typeNumber),i=0;i<e.length;i++)for(var n=0;n<e.length;n++){var a=e[i],r=e[n];if(null==this.modules[a][r])for(var o=-2;2>=o;o++)for(var s=-2;2>=s;s++)-2==o||2==o||-2==s||2==s||0==o&&0==s?this.modules[a+o][r+s]=!0:this.modules[a+o][r+s]=!1}},e.prototype.setupTypeNumber=function(e){for(var i=t.QRUtil.getBCHTypeNumber(this.typeNumber),n=0;18>n;n++){var a=!e&&1==(i>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=a}for(var n=0;18>n;n++){var a=!e&&1==(i>>n&1);this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=a}},e.prototype.setupTypeInfo=function(e,i){for(var n=this.errorCorrectLevel<<3|i,a=t.QRUtil.getBCHTypeInfo(n),r=0;15>r;r++){var o=!e&&1==(a>>r&1);6>r?this.modules[r][8]=o:8>r?this.modules[r+1][8]=o:this.modules[this.moduleCount-15+r][8]=o}for(var r=0;15>r;r++){var o=!e&&1==(a>>r&1);8>r?this.modules[8][this.moduleCount-r-1]=o:9>r?this.modules[8][15-r-1+1]=o:this.modules[8][15-r-1]=o}this.modules[this.moduleCount-8][8]=!e},e.prototype.mapData=function(e,i){for(var n=-1,a=this.moduleCount-1,r=7,o=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var h=0;2>h;h++)if(null==this.modules[a][s-h]){var c=!1;o<e.length&&(c=1==(e[o]>>>r&1));var l=t.QRUtil.getMask(i,a,s-h);l&&(c=!c),this.modules[a][s-h]=c,r--,-1==r&&(o++,r=7)}if(a+=n,0>a||this.moduleCount<=a){a-=n,n=-n;break}}},e.createData=function(i,n,a){for(var r=t.QRRSBlock.getRSBlocks(i,n),o=new t.QRBitBuffer,s=0;s<a.length;s++){var h=a[s];o.put(h.mode,4),o.put(h.getLength(),t.QRUtil.getLengthInBits(h.mode,i)),h.write(o)}for(var c=0,s=0;s<r.length;s++)c+=r[s].dataCount;if(o.getLengthInBits()>8*c)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+8*c+")");for(o.getLengthInBits()+4<=8*c&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*c)&&(o.put(e.PAD0,8),!(o.getLengthInBits()>=8*c));)o.put(e.PAD1,8);return e.createBytes(o,r)},e.createBytes=function(e,i){for(var n=0,a=0,r=0,o=new Array(i.length),s=new Array(i.length),h=0;h<i.length;h++){var c=i[h].dataCount,l=i[h].totalCount-c;a=Math.max(a,c),r=Math.max(r,l),o[h]=new Array(c);for(var u=0;u<o[h].length;u++)o[h][u]=255&e.buffer[u+n];n+=c;var p=t.QRUtil.getErrorCorrectPolynomial(l),d=new t.QRPolynomial(o[h],p.getLength()-1),g=d.mod(p);s[h]=new Array(p.getLength()-1);for(var u=0;u<s[h].length;u++){var f=u+g.getLength()-s[h].length;s[h][u]=f>=0?g.get(f):0}}for(var y=0,u=0;u<i.length;u++)y+=i[u].totalCount;for(var m=new Array(y),v=0,u=0;a>u;u++)for(var h=0;h<i.length;h++)u<o[h].length&&(m[v++]=o[h][u]);for(var u=0;r>u;u++)for(var h=0;h<i.length;h++)u<s[h].length&&(m[v++]=s[h][u]);return m},e.PAD0=236,e.PAD1=17,e}();t.QRCodeModel=e,__reflect(e.prototype,"qr.QRCodeModel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.L=1,t.M=0,t.Q=3,t.H=2,t}();t.QRErrorCorrectLevel=e,__reflect(e.prototype,"qr.QRErrorCorrectLevel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.PATTERN000=0,t.PATTERN001=1,t.PATTERN010=2,t.PATTERN011=3,t.PATTERN100=4,t.PATTERN101=5,t.PATTERN110=6,t.PATTERN111=7,t}();t.QRMaskPattern=e,__reflect(e.prototype,"qr.QRMaskPattern")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.glog=function(e){return t.isInit||t.init(),1>e&&console.log("错误:n="+e),t.LOG_TABLE[e]},t.gexp=function(e){for(t.isInit||t.init();0>e;)e+=255;for(;e>=256;)e-=255;return t.EXP_TABLE[e]},t.init=function(){t.isInit=!0;for(var e=0;8>e;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;256>e;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;255>e;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e},t.EXP_TABLE=new Array(256),t.LOG_TABLE=new Array(256),t}();t.QRMath=e,__reflect(e.prototype,"qr.QRMath")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.MODE_NUMBER=1,t.MODE_ALPHA_NUM=2,t.MODE_8BIT_BYTE=4,t.MODE_KANJI=8,t}();t.QRMode=e,__reflect(e.prototype,"qr.QRMode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var i=0;i<t.length&&0==t[i];)i++;this.num=new Array(t.length-i+e);for(var n=0;n<t.length-i;n++)this.num[n]=t[n+i]}return e.prototype.get=function(t){return this.num[t]},e.prototype.getLength=function(){return this.num.length},e.prototype.multiply=function(i){for(var n=new Array(this.getLength()+i.getLength()-1),a=0;a<this.getLength();a++)for(var r=0;r<i.getLength();r++)n[a+r]^=t.QRMath.gexp(t.QRMath.glog(this.get(a))+t.QRMath.glog(i.get(r)));return new e(n,0)},e.prototype.mod=function(i){if(this.getLength()-i.getLength()<0)return this;for(var n=t.QRMath.glog(this.get(0))-t.QRMath.glog(i.get(0)),a=new Array(this.getLength()),r=0;r<this.getLength();r++)a[r]=this.get(r);for(var r=0;r<i.getLength();r++)a[r]^=t.QRMath.gexp(t.QRMath.glog(i.get(r))+n);return new e(a,0).mod(i)},e}();t.QRPolynomial=e,__reflect(e.prototype,"qr.QRPolynomial")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.totalCount=t,this.dataCount=e}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,i){var n=e.getRsBlockTable(t,i);if(void 0==n)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+i);for(var a=n.length/3,r=[],o=0;a>o;o++)for(var s=n[3*o+0],h=n[3*o+1],c=n[3*o+2],l=0;s>l;l++)r.push(new e(h,c));return r},e.getRsBlockTable=function(i,n){switch(n){case t.QRErrorCorrectLevel.L:return e.RS_BLOCK_TABLE[4*(i-1)+0];case t.QRErrorCorrectLevel.M:return e.RS_BLOCK_TABLE[4*(i-1)+1];case t.QRErrorCorrectLevel.Q:return e.RS_BLOCK_TABLE[4*(i-1)+2];case t.QRErrorCorrectLevel.H:return e.RS_BLOCK_TABLE[4*(i-1)+3];default:return}},e}();t.QRRSBlock=e,__reflect(e.prototype,"qr.QRRSBlock")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.getBCHTypeInfo=function(t){for(var i=t<<10;e.getBCHDigit(i)-e.getBCHDigit(e.G15)>=0;)i^=e.G15<<e.getBCHDigit(i)-e.getBCHDigit(e.G15);return(t<<10|i)^e.G15_MASK},e.getBCHTypeNumber=function(t){for(var i=t<<12;e.getBCHDigit(i)-e.getBCHDigit(e.G18)>=0;)i^=e.G18<<e.getBCHDigit(i)-e.getBCHDigit(e.G18);return t<<12|i},e.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},e.getPatternPosition=function(t){return e.PATTERN_POSITION_TABLE[t-1]},e.getMask=function(e,i,n){switch(e){case t.QRMaskPattern.PATTERN000:return(i+n)%2==0;case t.QRMaskPattern.PATTERN001:return i%2==0;case t.QRMaskPattern.PATTERN010:return n%3==0;case t.QRMaskPattern.PATTERN011:return(i+n)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(i/2)+Math.floor(n/3))%2==0;case t.QRMaskPattern.PATTERN101:return i*n%2+i*n%3==0;case t.QRMaskPattern.PATTERN110:return(i*n%2+i*n%3)%2==0;case t.QRMaskPattern.PATTERN111:return(i*n%3+(i+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},e.getErrorCorrectPolynomial=function(e){for(var i=new t.QRPolynomial([1],0),n=0;e>n;n++)i=i.multiply(new t.QRPolynomial([1,t.QRMath.gexp(n)],0));return i},e.getLengthInBits=function(e,i){if(i>=1&&10>i)switch(e){case t.QRMode.MODE_NUMBER:return 10;case t.QRMode.MODE_ALPHA_NUM:return 9;case t.QRMode.MODE_8BIT_BYTE:return 8;case t.QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>i)switch(e){case t.QRMode.MODE_NUMBER:return 12;case t.QRMode.MODE_ALPHA_NUM:return 11;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>i))throw new Error("type:"+i);switch(e){case t.QRMode.MODE_NUMBER:return 14;case t.QRMode.MODE_ALPHA_NUM:return 13;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},e.getLostPoint=function(t){for(var e=t.getModuleCount(),i=0,n=0;e>n;n++)for(var a=0;e>a;a++){for(var r=0,o=t.isDark(n,a),s=-1;1>=s;s++)if(!(0>n+s||n+s>=e))for(var h=-1;1>=h;h++)0>a+h||a+h>=e||(0!=s||0!=h)&&o==t.isDark(n+s,a+h)&&r++;r>5&&(i+=3+r-5)}for(var n=0;e-1>n;n++)for(var a=0;e-1>a;a++){var c=0;t.isDark(n,a)&&c++,t.isDark(n+1,a)&&c++,t.isDark(n,a+1)&&c++,t.isDark(n+1,a+1)&&c++,(0==c||4==c)&&(i+=3)}for(var n=0;e>n;n++)for(var a=0;e-6>a;a++)t.isDark(n,a)&&!t.isDark(n,a+1)&&t.isDark(n,a+2)&&t.isDark(n,a+3)&&t.isDark(n,a+4)&&!t.isDark(n,a+5)&&t.isDark(n,a+6)&&(i+=40);for(var a=0;e>a;a++)for(var n=0;e-6>n;n++)t.isDark(n,a)&&!t.isDark(n+1,a)&&t.isDark(n+2,a)&&t.isDark(n+3,a)&&t.isDark(n+4,a)&&!t.isDark(n+5,a)&&t.isDark(n+6,a)&&(i+=40);for(var l=0,a=0;e>a;a++)for(var n=0;e>n;n++)t.isDark(n,a)&&l++;var u=Math.abs(100*l/e/e-50)/5;return i+=10*u},e.prototype.static_isSupportCanvas=function(){return"undefined"!=typeof CanvasRenderingContext2D},e._getTypeNumber=function(i,n){for(var a=1,r=e._getUTF8Length(i),o=0,s=e.QRCodeLimitLength.length;s>=o;o++){var h=0;switch(n){case t.QRErrorCorrectLevel.L:h=e.QRCodeLimitLength[o][0];break;case t.QRErrorCorrectLevel.M:h=e.QRCodeLimitLength[o][1];break;case t.QRErrorCorrectLevel.Q:h=e.QRCodeLimitLength[o][2];break;case t.QRErrorCorrectLevel.H:h=e.QRCodeLimitLength[o][3]}if(h>=r)break;a++}if(a>e.QRCodeLimitLength.length)throw new Error("Too long data");return a},e._getUTF8Length=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)},e.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],e.G15=1335,e.G18=7973,e.G15_MASK=21522,e.QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],e}();t.QRUtil=e,__reflect(e.prototype,"qr.QRUtil")}(qr||(qr={}));var AnchorUtils=function(){function t(){}return t.init=function(){this._propertyChange=Object.create(null),this._anchorChange=Object.create(null),this.injectAnchor()},t.setAnchorX=function(t,e){t.anchorX=e},t.setAnchorY=function(t,e){t.anchorY=e},t.setAnchor=function(t,e){t.anchorX=t.anchorY=e},t.getAnchor=function(t){return t.anchorX!=t.anchorY&&DebugUtils.log("target's anchorX != anchorY"),t.anchorX||0},t.getAnchorY=function(t){return t.anchorY||0},t.getAnchorX=function(t){return t.anchorX||0},t.injectAnchor=function(){Object.defineProperty(egret.DisplayObject.prototype,"width",{get:function(){return this.$getWidth()},set:function(e){var i=this;this.$setWidth(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"height",{get:function(){return this.$getHeight()},set:function(e){var i=this;this.$setHeight(e),t._propertyChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorX",{get:function(){return this._anchorX},set:function(e){var i=this;this._anchorX=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorY",{get:function(){return this._anchorY},set:function(e){var i=this;this._anchorY=e,t._propertyChange[this.hashCode]=!0,t._anchorChange[this.hashCode]=!0,egret.callLater(function(){t.changeAnchor(i)},this)},enumerable:!0,configurable:!0})},t.changeAnchor=function(t){this._propertyChange[t.hashCode]&&this._anchorChange[t.hashCode]&&(t.anchorOffsetX=t._anchorX*t.width,t.anchorOffsetY=t._anchorY*t.height,delete this._propertyChange[t.hashCode])},t}();__reflect(AnchorUtils.prototype,"AnchorUtils");var ArrayUtils=function(){function t(){}return t.forEach=function(t,e,i){for(var n=0,a=t.length;a>n;n++)e.apply(i,[t[n]])},t.copyTo=function(t,e){if(null!=t){null==e&&(e=[]);for(var i=0;i<t.length;i++)e.push(t[i])}},t.remove=function(t,e){var i=t.indexOf(e);t.splice(i,1)},t.random=function(t){if(null==t||0==t.length)return null;var e=Math.floor(Math.random()*t.length);return t[e]},t}();__reflect(ArrayUtils.prototype,"ArrayUtils");var DateUtils=function(){function t(){}return t.checkDay=function(t,e){return t.getFullYear()==e.getFullYear()&&t.getMonth()==e.getMonth()&&t.getDate()==e.getDate()},t.convertDate=function(t){return t.replace(/\-/g,"/")},t.howLongAgo=function(t){t=this.convertDate(t);var e=new Date(t).getTime(),i=(new Date).getTime(),n=i-e,a=Math.floor(n/1e3),r=Math.floor(n/6e4),o=Math.floor(n/36e5),s=Math.floor(n/864e5);return 60>a?a+"秒前":60>r?(a=Math.floor(n%6e4/1e3),r+"分"+a+"秒前"):24>o?o+"小时前":s+"天前"},t.getFormatBySecond=function(t,e){void 0===e&&(e=1);var i="";switch(e){case 0:i=this.getFormatBySecond0(t);break;case 1:i=this.getFormatBySecond1(t);break;case 2:i=this.getFormatBySecond2(t);break;case 3:i=this.getFormatBySecond3(t);break;case 4:i=this.getFormatBySecond4(t);break;case 5:i=this.getFormatBySecond5(t)}return i},t.getFormatBySecond0=function(t){void 0===t&&(t=0);var e,i,n=Math.floor(t/60),a=Math.floor(t%60);return e=0==n?"00":10>n?"0"+n:""+n,i=0==a?"00":10>a?"0"+a:""+a,e+":"+i},t.getFormatBySecond1=function(t){void 0===t&&(t=0);var e,i=Math.floor(t/3600);e=0==i?"00":10>i?"0"+i:""+i;var n,a,r=Math.floor((t-3600*i)/60),o=Math.floor((t-3600*i)%60);return n=0==r?"00":10>r?"0"+r:""+r,a=0==o?"00":10>o?"0"+o:""+o,e+":"+n+":"+a},t.getFormatBySecond3=function(t){void 0===t&&(t=0);var e,i,n=Math.floor(t/3600),a=Math.floor((t-3600*n)/60),r=Math.floor((t-3600*n)%60);return e=0==a?"00":10>a?"0"+a:""+a,i=0==r?"00":10>r?"0"+r:""+r,e+" : "+i},t.getFormatBySecond2=function(t){var e=new Date(t),i=e.getFullYear(),n=e.getMonth()+1,a=e.getDate(),r=e.getHours(),o=e.getMinutes(),s=e.getSeconds();return i+"-"+n+"-"+a+" "+r+":"+o+":"+s},t.getFormatBySecond4=function(t){var e=Math.floor(t/3600);return e>0?e>24?Math.floor(e/24)+"天前":e+"小时前":Math.floor(t/60)+"分钟前"},t.getFormatBySecond5=function(t){var e=86400,i=3600,n=60,a=Math.floor(t/e),r=Math.floor(t%e/i),o=Math.floor((t-r*i)/n),s=Math.floor((t-r*i)%n),h="",c="",l="",u="";return t>0?0==a?(h="",0==r?(c="",0==o?(l="",u=0==s?"":10>s?"0"+s+"秒":""+s+"秒"):(l=""+o+"分",u=0==s?"":10>s?"0"+s+"秒":""+s+"秒",l+u)):(c=r+"小时",0==o?(l="",u=0==s?"":10>s?"0"+s+"秒":""+s+"秒"):(l=10>o?"0"+o+"分":""+o+"分",c+l))):(h=a+"天",c=0==r?"":10>r?"0"+r+"小时":""+r+"小时",h+c):""
},t}();__reflect(DateUtils.prototype,"DateUtils");var DebugUtils=function(){function t(){}return t.isOpen=function(t){this._isOpen=t},Object.defineProperty(t,"isDebug",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),t.start=function(t){this._isOpen&&(this._startTimes[t]=egret.getTimer())},t.stop=function(t){if(!this._isOpen)return 0;if(!this._startTimes[t])return 0;var e=egret.getTimer()-this._startTimes[t];return e>this._threshold&&this.log(t+": "+e),e},t.setThreshold=function(t){this._threshold=t},t.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._isOpen&&(t[0]="[DebugLog]"+t[0],console.log.apply(console,t))},t._isOpen=!1,t._startTimes={},t._threshold=3,t}();__reflect(DebugUtils.prototype,"DebugUtils");var DisplayUtils=function(){function t(){}return t.createBitmap=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t.createMovieClip=function(t,e){void 0===e&&(e=null),null==e&&(e=t);var i=RES.getRes(t+"_json"),n=RES.getRes(t+"_png"),a=new egret.MovieClipDataFactory(i,n);return new egret.MovieClip(a.generateMovieClipData(e))},t.loadImage=function(t,e){void 0===e&&(e=null);var i=new egret.ImageLoader;i.once(egret.Event.COMPLETE,function(t){var i=new egret.Texture;i._setBitmapData(t.currentTarget.data),e&&e(i)},this),i.load(t)},t.removeFromParent=function(t){null!=t.parent&&t.parent.removeChild(t)},t}();__reflect(DisplayUtils.prototype,"DisplayUtils");var DrawUtils=function(){function t(){}return t.drawRoundHexagon=function(t,e,i,n){var a=t.graphics;a.clear(),a.lineStyle(i,n),a.beginFill(n),e-=Math.ceil(i/2),a.moveTo(-e/2,-e*Math.sqrt(3)/2),a.lineTo(e/2,-e*Math.sqrt(3)/2),a.lineTo(e,0),a.lineTo(e/2,e*Math.sqrt(3)/2),a.lineTo(-e/2,e*Math.sqrt(3)/2),a.lineTo(-e,0),a.lineTo(-e/2,-e*Math.sqrt(3)/2),a.endFill()},t.drawRect=function(t,e,i,n,a,r){void 0===a&&(a=0),void 0===r&&(r=0);var o=t.graphics;o.clear(),o.beginFill(n),o.drawRoundRect(0,0,e,i,a,r),o.endFill()},t.drawArc=function(t,e,i){var n=t.graphics;n.clear(),n.beginFill(i),n.lineTo(200,0),n.drawArc(0,0,200,-198*Math.PI/180,e*Math.PI/180,!0),n.lineTo(0,0),n.endFill()},t.drawRectPos=function(t,e,i,n,a,r,o){var s=t.graphics;s.beginFill(r,o),s.drawRect(e,i,n,a),s.endFill()},t.drawRoundRect=function(t,e,i,n,a,r){var o=t.graphics;o.clear(),o.beginFill(r),o.drawRoundRect(0,0,e,i,n,a),o.endFill()},t.drawRoundRectContinue=function(t,e,i,n,a,r,o,s){var h=t.graphics;h.beginFill(s),h.drawRoundRect(e,i,n,a,r,o),h.endFill()},t.drawHollowRect=function(t,e,i,n,a){var r=t.graphics;r.clear(),r.lineStyle(n,a),r.moveTo(n/2,n/2),r.lineTo(e+n/2,n/2),r.lineTo(e+n/2,i+n/2),r.lineTo(n/2,i+n/2),r.lineTo(n/2,n/2)},t.drawTriangle=function(t,e,i,n){var a=t.graphics;a.clear(),a.lineStyle(i,n);var r=function(t){return e*Math.cos((60*t+30)/180*Math.PI)},o=function(t){return e*Math.sin((60*t+30)/180*Math.PI)};a.moveTo(r(0),o(0)),a.lineTo(r(2),o(2)),a.lineTo(r(4),o(4)),a.lineTo(r(0),o(0))},t.drawStar=function(t,e,i,n){var a=t.graphics;a.clear(),a.lineStyle(i,n);var r=function(t){return e*Math.cos((72*t-18)/180*Math.PI)},o=function(t){return e*Math.sin((72*t-18)/180*Math.PI)};a.moveTo(r(0),o(0)),a.lineTo(r(2),o(2)),a.lineTo(r(4),o(4)),a.lineTo(r(1),o(1)),a.lineTo(r(3),o(3)),a.lineTo(r(0),o(0))},t.drawCross=function(t,e,i,n){var a=t.graphics;a.clear(),a.lineStyle(i,n),a.moveTo(-e/2,0),a.lineTo(e/2,0),a.moveTo(0,-e/2),a.lineTo(0,e/2)},t.drawMi=function(t,e,i,n){var a=t.graphics;a.clear(),a.lineStyle(i,n),a.moveTo(-e/2,0),a.lineTo(e/2,0),a.moveTo(0,-e/2),a.lineTo(0,e/2);var r=Math.sin(Math.PI/4);a.moveTo(e/2*-r,e/2*-r),a.lineTo(e/2*r,e/2*r),a.moveTo(e/2*-r,e/2*r),a.lineTo(e/2*r,e/2*-r)},t.drawCircle=function(t,e,i){var n=t.graphics;n.clear(),n.beginFill(i),n.drawCircle(0,0,e),n.endFill()},t.drawLine=function(t,e,i,n,a){var r=t.graphics;r.clear(),r.lineStyle(n,a),r.moveTo(e.x,e.y),r.lineTo(i.x,i.y),t.graphics.endFill()},t.drawLineContinue=function(t,e,i,n,a){var r=t.graphics;r.lineStyle(n,a),r.moveTo(e.x,e.y),r.lineTo(i.x,i.y),t.graphics.endFill()},t}();__reflect(DrawUtils.prototype,"DrawUtils");var MathUtils=function(){function t(){}return t.cacuDistance=function(t,e,i,n){return Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2))},t.lineRectIntersection=function(t,e,i){var n=t.y-e.y,a=e.x-t.x,r=t.x*e.y-e.x*t.y,o=i.x,s=i.y,h=i.x+i.width,c=i.y+i.height;return this.pointInRect(t,i)||this.pointInRect(e,i)?!0:n*o+a*s+r>=0&&0>=n*h+a*c+r||0>=n*o+a*s+r&&n*h+a*c+r>=0||n*o+a*c+r>=0&&0>=n*h+a*s+r||n*o+a*c+r>=0&&0>=n*h+a*s+r?t.x<o&&e.x<o||t.x>h&&e.x<o||t.y>s&&e.y>s||t.y<c&&e.y<c?!1:!0:!1},t.pointInRect=function(t,e){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},t.random=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var i=e-t;return t+Math.random()*i},t.randomInt=function(t,e){return Math.floor(this.random(t,e+1))},t.checkMobile=function(t){return t&&null!=t.match("^1[3|4|5|7|8][0-9]\\d{8}$")},t.checkName=function(t){return t&&null!=t.match("^[一-龥]{2,7}$")},t.between=function(t,e,i){return Math.min(Math.max(e,t),i)},t}();__reflect(MathUtils.prototype,"MathUtils");var ObjectPool=function(){function t(){}return t.pop=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t._content[e]||(t._content[e]=[]);var a=t._content[e];if(a.length)return a.pop();var r,o=egret.getDefinitionByName(e),s=i.length;return 0==s?r=new o:1==s?r=new o(i[0]):2==s?r=new o(i[0],i[1]):3==s?r=new o(i[0],i[1],i[2]):4==s?r=new o(i[0],i[1],i[2],i[3]):5==s&&(r=new o(i[0],i[1],i[2],i[3],i[4])),r.ObjectPoolKey=e,r},t.popWithExtraKey=function(e,i){t._content[e]||(t._content[e]=[]);var n,a=t._content[e];if(a.length)for(var r=0;r<a.length;r++)if(a[r].extraKey==i){n=a[r],a.splice(r,1);break}if(!n){var o=egret.getDefinitionByName(e);n=new o(i),n.extraKey=i,n.ObjectPoolKey=e}return n},t.push=function(e){if(null==e)return!1;var i=e.ObjectPoolKey,n=t._content[i];return!n||n.indexOf(e)>=0?!1:(t._content[i].push(e),!0)},t.clear=function(){t._content={}},t.clearClass=function(e,i){void 0===i&&(i=null);for(var n=t._content[e];n&&n.length;){var a=n.pop();i&&a[i](),a=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,i){var n=t._content[e];if(null!=n){var a=0,r=n.length;for(a;r>a;a++)n[a][i]()}},t._content={},t}();__reflect(ObjectPool.prototype,"ObjectPool");var StageUtils=function(){function t(){}return Object.defineProperty(t,"stage",{get:function(){return egret.MainContext.instance.stage},enumerable:!0,configurable:!0}),Object.defineProperty(t,"stageW",{get:function(){return egret.MainContext.instance.stage.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t,"stageH",{get:function(){return egret.MainContext.instance.stage.stageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t,"sca",{get:function(){return egret.MainContext.instance.stage.stageWidth/640},enumerable:!0,configurable:!0}),t}();__reflect(StageUtils.prototype,"StageUtils");var TimerManager=function(){function t(){}return t.init=function(){this._handlers=new Array,this._delHandlers=new Array,this._currTime=egret.getTimer(),this._currFrame=0,this._count=0,this._timeScale=1,egret.Ticker.getInstance().register(this.onEnterFrame,this)},t.setTimeScale=function(t){this._timeScale=t},t.getTimeScale=function(){return this._timeScale},t.onEnterFrame=function(){this._currFrame++,this._currTime=egret.getTimer(),DebugUtils.start("TimerManager:");for(var t=0;t<this._count;t++){var e=this._handlers[t],i=e.userFrame?this._currFrame:this._currTime;i>=e.exeTime&&(DebugUtils.start(e.method.toString()),e.method.call(e.methodObj,(this._currTime-e.dealTime)*this._timeScale),DebugUtils.stop(e.method.toString()),e.dealTime=this._currTime,e.exeTime+=e.delay,e.repeat||(e.repeatCount>1?e.repeatCount--:(e.complateMethod&&e.complateMethod.apply(e.complateMethodObj),this._delHandlers.push(e))))}for(;this._delHandlers.length;){var e=this._delHandlers.pop();e.repeat||this.remove(e.method,e.methodObj)}DebugUtils.stop("TimerManager:")},t.create=function(t,e,i,n,a,r,o){if(!(0>e||0>i||null==n)){this.remove(n,a);var s=ObjectPool.pop("TimerHandler");s.userFrame=t,s.repeat=0==i,s.repeatCount=i,s.delay=e,s.method=n,s.methodObj=a,s.complateMethod=r,s.complateMethodObj=o,s.exeTime=e+(t?this._currFrame:this._currTime),s.dealTime=this._currTime,this._handlers.push(s),this._count++}},t.doTimer=function(t,e,i,n,a,r){void 0===a&&(a=null),void 0===r&&(r=null),this.create(!1,t,e,i,n,a,r)},t.doFrame=function(t,e,i,n,a,r){void 0===a&&(a=null),void 0===r&&(r=null),this.create(!0,t,e,i,n,a,r)},Object.defineProperty(t,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),t.remove=function(t,e){for(var i=0;i<this._count;i++){var n=this._handlers[i];if(n.method==t&&n.methodObj==e){this._handlers.splice(i,1),ObjectPool.push(n),this._count--;break}}},t.removeAll=function(t){for(var e=0;e<this._count;e++){var i=this._handlers[e];i.methodObj==t&&(this._handlers.splice(e,1),ObjectPool.push(i),this._count--,e--)}},t.clear=function(){for(var t=0;t<this._count;t++){var e=this._handlers[t];this._handlers.splice(t,1),ObjectPool.push(e),this._count--,t--}},t.isExists=function(t,e){for(var i=0;i<this._count;i++){var n=this._handlers[i];if(n.method==t&&n.methodObj==e)return!0}return!1},t}();__reflect(TimerManager.prototype,"TimerManager");var TimerHandler=function(){function t(){this.delay=0,this.repeatCount=0,this.exeTime=0,this.dealTime=0}return t.prototype.clear=function(){this.method=null,this.methodObj=null,this.complateMethod=null,this.complateMethodObj=null},t}();__reflect(TimerHandler.prototype,"TimerHandler");var Button=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onTap,e),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.touchBegin,e),e.addEventListener(egret.TouchEvent.TOUCH_END,e.touchEnd,e),e.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,e.touchEnd,e),e.touchEnabled=!0,e.terms=[],e.callBack=null,e.canTouch=!0,e}return __extends(e,t),e.prototype.touchBegin=function(){egret.Tween.get(this).to({scaleX:.9,scaleY:.9},80,egret.Ease.quadOut)},e.prototype.touchEnd=function(){var t=this;egret.Tween.get(this).to({scaleX:1,scaleY:1},80,egret.Ease.quadOut).call(function(){t.canTouch=!0})},e.prototype.onTap=function(t){if(this.canTouch){this.canTouch=!1;for(var e=0;e<this.terms.length;e++)if(!this.terms[e])return;this.callBack&&this.callBack(t)}},e.prototype.addTerm=function(t){this.terms.push(t)},e.prototype.setOnTap=function(t){this.callBack=t},e}(eui.Button);__reflect(Button.prototype,"Button");var Direction;!function(t){t[t.UP=1]="UP",t[t.DOWN=2]="DOWN",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(Direction||(Direction={}));var LayerManager=function(){function t(){this._layers=[];for(var t=["scene","dialog","popwin"],e=0;3>e;e++){var i=new egret.DisplayObjectContainer;StageUtils.stage.addChild(i),this._layers[e]=i,i.name=t[e]}}return t.prototype.addToLayer=function(t,e){this._layers[e].addChild(t)},Object.defineProperty(t,"I",{get:function(){return this._instance||(this._instance=new t)},enumerable:!0,configurable:!0}),t}();__reflect(LayerManager.prototype,"LayerManager");var Layer;!function(t){t[t.SCENE=0]="SCENE",t[t.DIALOG=1]="DIALOG",t[t.POPWIN=2]="POPWIN"}(Layer||(Layer={}));var Head=function(t){function e(){var e=t.call(this)||this;return e.once(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.init=function(){var t=new egret.Shape;this.parent.addChild(t),t.x=this.x,t.y=this.y;var e=t.graphics;e.beginFill(0),e.drawRoundRect(0,0,this.width,this.height,this.width/3,this.width/3),e.endFill(),this.mask=t},e.prototype.setImage=function(t){null==t||""==t?this.source="game_json.head":this.source=t},e}(eui.Image);__reflect(Head.prototype,"Head");var Rect=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.width=i,this.height=n}return t}();__reflect(Rect.prototype,"Rect");var ViewManager=function(){function t(){this._views={}}return t.prototype.open=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.getView(t)||this.createView(t);return n.open.apply(n,e),n},t.prototype.close=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.getView(t);n.close.apply(n,e)},t.prototype.doFunc=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var a=this.getView(t);a[e].apply(a,i)},t.prototype.getView=function(t){return this._views[t]},t.prototype.createView=function(t){var e=ObjectPool.pop(t);return this._views[t]=e,e},Object.defineProperty(t,"I",{get:function(){return this._instance||(this._instance=new t)},enumerable:!0,configurable:!0}),t}();__reflect(ViewManager.prototype,"ViewManager");var ViewName=function(){function t(){}return t.LOGIN="LoginScene",t.LOADING="LoadingScene",t.GAME="GameScene",t.BACKUP="BackupScene",t.HTTP="HttpLoading",t.DLG_LOGIN_TASK="DlgLoginTask",t.DLG_DAILY_TASK="DlgDailyTask",t.DLG_DAILY_GIFT="DlgDailyGift",t.DLG_NOTICE="DlgNotice",t.DLG_TOY_INFO="DlgToyInfo",t.DLG_CATCH_TOY="DlgCatchToy",t.DLG_CHOOSE_ROOM="DlgChooseRoom",t.DLG_BAG="DlgBag",t.DLG_INVITE="DlgInvite",t.DLG_BIND="DlgBind",t.DLG_SETTING="DlgSetting",t.DLG_SHOW="DlgShow",t.DLG_CHARGE="DlgCharge",t.POP_HINT="PopHint",t.POP_ALERT="PopAlert",t}();__reflect(ViewName.prototype,"ViewName");